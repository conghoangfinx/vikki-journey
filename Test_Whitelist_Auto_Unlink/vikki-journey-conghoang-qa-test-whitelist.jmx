<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0" jmeter="5.6.3">
  <hashTree>
    <TestPlan guiclass="TestPlanGui" testclass="TestPlan" testname="Vikki Journey">
      <boolProp name="TestPlan.functional_mode">true</boolProp>
      <boolProp name="TestPlan.serialize_threadgroups">true</boolProp>
      <elementProp name="TestPlan.user_defined_variables" elementType="Arguments" guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
        <collectionProp name="Arguments.arguments"/>
      </elementProp>
      <stringProp name="TestPlan.user_define_classpath">./lib</stringProp>
    </TestPlan>
    <hashTree>
      <Arguments guiclass="ArgumentsPanel" testclass="Arguments" testname="Defined Variables - UAT">
        <collectionProp name="Arguments.arguments">
          <elementProp name="scheme" elementType="Argument">
            <stringProp name="Argument.name">scheme</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.value">https</stringProp>
          </elementProp>
          <elementProp name="host" elementType="Argument">
            <stringProp name="Argument.name">host</stringProp>
            <stringProp name="Argument.value">ingress-int.uat.galaxyfinx.in</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">UAT</stringProp>
          </elementProp>
          <elementProp name="internalKey" elementType="Argument">
            <stringProp name="Argument.name">internalKey</stringProp>
            <stringProp name="Argument.value">UvzUJdDucBtgFvNxu9F7XzpyA</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="adminKey" elementType="Argument">
            <stringProp name="Argument.name">adminKey</stringProp>
            <stringProp name="Argument.value">yZn7UbifwbvhuNihUsvYOgurk</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="publicKey" elementType="Argument">
            <stringProp name="Argument.name">publicKey</stringProp>
            <stringProp name="Argument.value">GfS39omUfRHReT3G02sSYTIpF</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="hpvOcrMockingId" elementType="Argument">
            <stringProp name="Argument.name">hpvOcrMockingId</stringProp>
            <stringProp name="Argument.value">d596264e-f918-4e4a-a7ee-1423481f18f8</stringProp>
            <stringProp name="Argument.desc">Wiremock ID</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="hdbBiometricMockingId" elementType="Argument">
            <stringProp name="Argument.name">hdbBiometricMockingId</stringProp>
            <stringProp name="Argument.value">bf3e65fb-4fc0-4cea-bccc-d4c906744ea3</stringProp>
            <stringProp name="Argument.desc">Wiremock ID</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="phoneNumberOnboard" elementType="Argument">
            <stringProp name="Argument.name">phoneNumberOnboard</stringProp>
            <stringProp name="Argument.value"></stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Prefix must 9900</stringProp>
          </elementProp>
          <elementProp name="idNumberOnboard" elementType="Argument">
            <stringProp name="Argument.name">idNumberOnboard</stringProp>
            <stringProp name="Argument.value"></stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc"></stringProp>
          </elementProp>
          <elementProp name="AMLMockingId" elementType="Argument">
            <stringProp name="Argument.name">AMLMockingId</stringProp>
            <stringProp name="Argument.value">b85c6ffd-ad77-4988-9747-4daebeb5c598</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="hdbCheckMockingId" elementType="Argument">
            <stringProp name="Argument.name">hdbCheckMockingId</stringProp>
            <stringProp name="Argument.value">fbe887ef-aff6-401f-ac23-e58462e3cdfe</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
        </collectionProp>
      </Arguments>
      <hashTree/>
      <Arguments guiclass="ArgumentsPanel" testclass="Arguments" testname="Defined Variables - SIT" enabled="false">
        <collectionProp name="Arguments.arguments">
          <elementProp name="scheme" elementType="Argument">
            <stringProp name="Argument.name">scheme</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.value">https</stringProp>
          </elementProp>
          <elementProp name="host" elementType="Argument">
            <stringProp name="Argument.name">host</stringProp>
            <stringProp name="Argument.value">ingress-int.sit.galaxyfinx.in</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">UAT</stringProp>
          </elementProp>
          <elementProp name="internalKey" elementType="Argument">
            <stringProp name="Argument.name">internalKey</stringProp>
            <stringProp name="Argument.value">hF35bcI4A2g6JUb4lrs0cvM5t</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="adminKey" elementType="Argument">
            <stringProp name="Argument.name">adminKey</stringProp>
            <stringProp name="Argument.value">5jrEGY49i8OV8tmEOC5euLQW6</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="publicKey" elementType="Argument">
            <stringProp name="Argument.name">publicKey</stringProp>
            <stringProp name="Argument.value">uX6YVolBtq4lEOsFBYitJrR8B</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="hpvOcrMockingId" elementType="Argument">
            <stringProp name="Argument.name">hpvOcrMockingId</stringProp>
            <stringProp name="Argument.value">d596264e-f918-4e4a-a7ee-1423481f18f8</stringProp>
            <stringProp name="Argument.desc">Wiremock ID</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="hdbBiometricMockingId" elementType="Argument">
            <stringProp name="Argument.name">hdbBiometricMockingId</stringProp>
            <stringProp name="Argument.value">bf3e65fb-4fc0-4cea-bccc-d4c906744ea3</stringProp>
            <stringProp name="Argument.desc">Wiremock ID</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="phoneNumberOnboard" elementType="Argument">
            <stringProp name="Argument.name">phoneNumberOnboard</stringProp>
            <stringProp name="Argument.value"></stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Prefix must 9900</stringProp>
          </elementProp>
          <elementProp name="idNumberOnboard" elementType="Argument">
            <stringProp name="Argument.name">idNumberOnboard</stringProp>
            <stringProp name="Argument.value"></stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc"></stringProp>
          </elementProp>
          <elementProp name="AMLMockingId" elementType="Argument">
            <stringProp name="Argument.name">AMLMockingId</stringProp>
            <stringProp name="Argument.value">b85c6ffd-ad77-4988-9747-4daebeb5c598</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
          <elementProp name="hdbCheckMockingId" elementType="Argument">
            <stringProp name="Argument.name">hdbCheckMockingId</stringProp>
            <stringProp name="Argument.value">fbe887ef-aff6-401f-ac23-e58462e3cdfe</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
          </elementProp>
        </collectionProp>
      </Arguments>
      <hashTree/>
      <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Request Defaults" enabled="true">
        <intProp name="HTTPSampler.connect_timeout">50000</intProp>
        <intProp name="HTTPSampler.response_timeout">50000</intProp>
        <stringProp name="HTTPSampler.domain">${host}</stringProp>
        <stringProp name="HTTPSampler.port">443</stringProp>
        <stringProp name="HTTPSampler.protocol">${scheme}</stringProp>
        <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
          <collectionProp name="Arguments.arguments"/>
        </elementProp>
        <stringProp name="HTTPSampler.implementation"></stringProp>
      </ConfigTestElement>
      <hashTree/>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="Onboarding" enabled="true">
        <stringProp name="ThreadGroup.num_threads">${__P(threads,1)}</stringProp>
        <stringProp name="ThreadGroup.ramp_time">${__P(rampups, 30)}</stringProp>
        <stringProp name="ThreadGroup.duration">${__P(durations,600)}</stringProp>
        <longProp name="ThreadGroup.delay">5</longProp>
        <boolProp name="ThreadGroup.same_user_on_next_iteration">false</boolProp>
        <stringProp name="ThreadGroup.on_sample_error">stoptestnow</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller">
          <stringProp name="LoopController.loops">1</stringProp>
          <boolProp name="LoopController.continue_forever">false</boolProp>
        </elementProp>
      </ThreadGroup>
      <hashTree>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="GENERATE PHONE AND ID NUMBER - Single" enabled="false">
          <stringProp name="scriptLanguage">groovy</stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="script">import java.text.SimpleDateFormat
import java.util.Random

//log.info(&quot;\n---------- GENERATE PHONE AND ID NUMBER ----------&quot;)

// ✅ Lấy biến __threadNum, đảm bảo giá trị không null và kiểu số nguyên
def threadNum = ${__threadNum}  // Tránh null, đảm bảo số nguyên

// ✅ Lấy thời gian hiện tại với các định dạng mong muốn
def currentDate = new Date()
def dateFormatSSddMMHHmm = new SimpleDateFormat(&quot;ssddMMHHmm&quot;)  // Định dạng giây - ngày - tháng - giờ - phút
def dateFormatHHmm = new SimpleDateFormat(&quot;HHmm&quot;)  // Định dạng HHmm (giờ, phút)
def dateFormatss = new SimpleDateFormat(&quot;ss&quot;)  // Định dạng ssHHmm (giây)
def formattedDate = dateFormatSSddMMHHmm.format(currentDate)  // Ngày tháng năm giờ phút
def formattedTimeHHmm = dateFormatHHmm.format(currentDate)  // Giờ phút hiện tại
def formattedTimess = dateFormatss.format(currentDate)  // Giờ phút hiện tại

// ✅ Sinh ra 2 số ngẫu nhiên cho idNumberOnboard
Random rand = new Random()
def randomPart = String.format(&quot;%02d&quot;, rand.nextInt(100))  // 2 số ngẫu nhiên từ 00 - 99

// ✅ Kiểm tra và tạo số điện thoại nếu chưa có giá trị
//def phoneNumberOnboard = vars.get(&quot;phoneNumberOnboard&quot;) ?: &quot;990&quot; + randomPart + formattedTimeHHmm
def phoneNumberOnboard = vars.get(&quot;phoneNumberOnboard&quot;) ?: &quot;990&quot; + String.format(&quot;%02d&quot;, threadNum) + formattedTimeHHmm
//def phoneNumberOnboard = vars.get(&quot;phoneNumberOnboard&quot;) ?: &quot;990&quot; + formattedTimess + formattedTimeHHmm

// ✅ Kiểm tra và tạo số căn cước nếu chưa có giá trị
def idNumberOnboard = vars.get(&quot;idNumberOnboard&quot;) ?: String.format(&quot;%02d&quot;, threadNum) + formattedDate
//def idNumberOnboard = vars.get(&quot;idNumberOnboard&quot;) ?: randomPart + formattedDate

// ✅ Gán lại giá trị vào biến JMeter
vars.put(&quot;phoneNumberOnboard&quot;, phoneNumberOnboard)
vars.put(&quot;idNumberOnboard&quot;, idNumberOnboard)

</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="GENERATE PHONE AND ID NUMBER - Multiple" enabled="true">
          <stringProp name="scriptLanguage">groovy</stringProp>
          <stringProp name="parameters"></stringProp>
          <stringProp name="filename"></stringProp>
          <stringProp name="cacheKey">true</stringProp>
          <stringProp name="script">import java.text.SimpleDateFormat
import java.util.Random

//log.info(&quot;\n---------- GENERATE PHONE AND ID NUMBER ----------&quot;)

// ✅ Lấy biến __threadNum, đảm bảo giá trị không null và kiểu số nguyên
def threadNum = ${__threadNum}  // Tránh null, đảm bảo số nguyên

// ✅ Lấy thời gian hiện tại với các định dạng mong muốn
def currentDate = new Date()
def dateFormatSSddMMHHmm = new SimpleDateFormat(&quot;ssddMMHHmm&quot;)  // Định dạng giây - ngày - tháng - giờ - phút
def dateFormatHHmm = new SimpleDateFormat(&quot;HHmm&quot;)  // Định dạng HHmm (giờ, phút)
def dateFormatss = new SimpleDateFormat(&quot;ss&quot;)  // Định dạng ssHHmm (giây)
def formattedDate = dateFormatSSddMMHHmm.format(currentDate)  // Ngày tháng năm giờ phút
def formattedTimeHHmm = dateFormatHHmm.format(currentDate)  // Giờ phút hiện tại
def formattedTimess = dateFormatss.format(currentDate)  // Giờ phút hiện tại

// ✅ Sinh ra 2 số ngẫu nhiên cho idNumberOnboard
Random rand = new Random()
def randomPart = String.format(&quot;%02d&quot;, rand.nextInt(100))  // 2 số ngẫu nhiên từ 00 - 99

// ✅ Kiểm tra và tạo số điện thoại nếu chưa có giá trị
//def phoneNumberOnboard = vars.get(&quot;phoneNumberOnboard&quot;) ?: &quot;990&quot; + randomPart + formattedTimeHHmm
//def phoneNumberOnboard = vars.get(&quot;phoneNumberOnboard&quot;) ?: &quot;990&quot; + String.format(&quot;%02d&quot;, threadNum) + formattedTimeHHmm
def phoneNumberOnboard = vars.get(&quot;phoneNumberOnboard&quot;) ?: &quot;990&quot; + formattedTimess + formattedTimeHHmm

// ✅ Kiểm tra và tạo số căn cước nếu chưa có giá trị
def idNumberOnboard = vars.get(&quot;idNumberOnboard&quot;) ?: String.format(&quot;%02d&quot;, threadNum) + formattedDate
//def idNumberOnboard = vars.get(&quot;idNumberOnboard&quot;) ?: randomPart + formattedDate

// ✅ Gán lại giá trị vào biến JMeter
vars.put(&quot;phoneNumberOnboard&quot;, phoneNumberOnboard)
vars.put(&quot;idNumberOnboard&quot;, idNumberOnboard)

</stringProp>
        </JSR223PreProcessor>
        <hashTree/>
        <IfController guiclass="IfControllerPanel" testclass="IfController" testname="1. Check and Clear Account" enabled="true">
          <stringProp name="IfController.condition">${__groovy(vars.get(&quot;phoneNumberOnboard&quot;) != null)}</stringProp>
          <boolProp name="IfController.evaluateAll">false</boolProp>
          <boolProp name="IfController.useExpression">true</boolProp>
        </IfController>
        <hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="1.1 NID - Get Prospect" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v2/prospect/internal/lookup</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;type&quot;: &quot;national_id&quot;,&#xd;
    &quot;value&quot;: &quot;${idNumberOnboard}&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n\n=============== !!! CHECK AND CLEAR ACCOUNT !!! ===============\n\n&quot;);
log.info(&quot;\n 1.1 ---------- NID - GET PROSPECT ----------&quot;)

// ✅ Lấy thông tin từ request trước đó
def response = prev.getResponseDataAsString().trim()
def responseCode = prev.getResponseCode().toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()

// ✅ Log thông tin cơ bản về request
log.info(&quot;${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra response code và log lỗi nếu không phải 200
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Parse JSON an toàn
def jsonResponse
try {
    jsonResponse = new JsonSlurper().parseText(response)
} catch (Exception e) {
    log.error(&quot;❌ Error parsing JSON: ${e.message}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Trích xuất và log thông tin cần thiết
def phoneNumber = jsonResponse?.payload?.phoneNumber
def prospectId = jsonResponse?.payload?.idCardFront?.imageName?.split(&apos;_&apos;)?.first()

// Log Prospect ID nếu tìm thấy
if (prospectId) {
    vars.put(&quot;prospectIdOfNID&quot;, prospectId)
//    log.info(&quot;✅ ProspectID of NID: ${prospectId}&quot;)
} else {
    log.warn(&quot;✅ Prospect ID not found!&quot;)
}

// Log phoneNumber nếu tìm thấy
if (phoneNumber) {
    vars.put(&quot;phoneNumberOfNIDOld&quot;, phoneNumber.toString())
    log.info(&quot;✅ Phone of NID: ${phoneNumber}&quot;)
} else {
    log.warn(&quot;✅ Phone number not found in NID prospect&quot;)
}
</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <IfController guiclass="IfControllerPanel" testclass="IfController" testname="1.2 NID - Clear Prospect" enabled="true">
            <stringProp name="IfController.condition">${__groovy(
    def prospectIdOfNID = vars.get(&quot;prospectIdOfNID&quot;)
    if (prospectIdOfNID != null) {
        return true
    } else {
        return false
    }
)}</stringProp>
            <boolProp name="IfController.evaluateAll">false</boolProp>
            <boolProp name="IfController.useExpression">true</boolProp>
          </IfController>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="1.2 Clear Prospect of NID" enabled="true">
              <stringProp name="HTTPSampler.path">/v2/onboarding/admin/prospect/${prospectIdOfNID}/clean-prospect</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
  &quot;removeAllFaces&quot;: true&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                <collectionProp name="HeaderManager.headers">
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">Content-Type</stringProp>
                    <stringProp name="Header.value">application/json</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">X-KEY</stringProp>
                    <stringProp name="Header.value">${adminKey}</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">secret-key</stringProp>
                    <stringProp name="Header.value">izyMW6MEhhjN0KQfjyb11DwM9XuJyYU6</stringProp>
                  </elementProp>
                </collectionProp>
              </HeaderManager>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n 1.2 ---------- NID - CLEAR PROSPECT ----------&quot;)

// ✅ Lấy thông tin từ request trước đó
def response = prev.getResponseDataAsString().trim()
def responseCode = prev.getResponseCode().toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()

// ✅ Log thông tin cơ bản
log.info(&quot;${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra và log nếu response code là 400 (Prospect not found)
if (responseCode == &quot;400&quot;) {
    def jsonResponse = new JsonSlurper().parseText(response)
    log.warn(&quot;❌ Prospect of NID not found!&quot;)
    return false // Dừng nếu không tìm thấy prospect
}

// ✅ Kiểm tra và log nếu response code là 200 (Clear Success)
if (responseCode == &quot;200&quot;) {
    def jsonResponse = new JsonSlurper().parseText(response)
    if (jsonResponse.success == true) {
        log.info(&quot;✅ Prospect of NID has been successfully cleared!&quot;)
    } else {
        log.warn(&quot;❌ Clear Prospect of NID failed! Response Message: ${jsonResponse.status.message}&quot;)
    }
    return true // Thành công
}

// ✅ Kiểm tra và log các lỗi khác (500, 502, etc.)
if (responseCode != &quot;200&quot; &amp;&amp; responseCode != &quot;400&quot;) {
    log.error(&quot;❌ Unexpected Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return false // Dừng nếu có lỗi khác
}

return true // Đảm bảo trả về true nếu không có lỗi nào
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="1.3 NID - Get CIF" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/api/party-service/v2/admin/parties/lookup</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;type&quot;: &quot;national_id&quot;,&#xd;
    &quot;value&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
    &quot;queryParams&quot;: [&quot;cif&quot;]&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${adminKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n 1.3 ---------- NID - GET CIF ----------&quot;)

// ✅ Lấy thông tin từ response trước đó
def response = prev.getResponseDataAsString()?.trim() // Kiểm tra null tránh lỗi
def responseCode = prev.getResponseCode()?.toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()

// ✅ Log thông tin cơ bản của request
log.info(&quot;${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra nếu response code là 400 (Not Found)
if (responseCode == &quot;400&quot;) {
    prev.setResponseOK() // Đánh dấu request thành công dù không tìm thấy dữ liệu
    log.warn(&quot;✅ Not Found ID Number Party.&quot;)
    return
}

// ✅ Kiểm tra và log nếu response code khác 200 (lỗi ngoài mong đợi)
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Parse JSON an toàn
def jsonResponse
try {
    jsonResponse = new JsonSlurper().parseText(response) // Parse response JSON
} catch (Exception e) {
    log.error(&quot;❌ JSON Parsing Error: ${e.message}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Trích xuất thông tin tài khoản
def statusAccount = jsonResponse?.payload?.status ?: &quot;UNKNOWN&quot; // Mặc định &quot;UNKNOWN&quot;
def cifNumberOfNID = jsonResponse?.payload?.cif ?: &quot;N/A&quot; // Mặc định &quot;N/A&quot;

// ✅ Lưu giá trị vào biến JMeter
vars.put(&quot;cifNumberOfNID&quot;, cifNumberOfNID) 
vars.put(&quot;statusAccount&quot;, statusAccount)


// ✅ Log thông tin tài khoản
log.info(&quot;✅ CIF of NID: ${cifNumberOfNID} | Status: ${statusAccount}&quot;)</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <IfController guiclass="IfControllerPanel" testclass="IfController" testname="1.4 NID - Clear CIF" enabled="true">
            <stringProp name="IfController.condition">${__groovy(vars.get(&apos;statusAccount&apos;) == &apos;Active&apos;)}</stringProp>
            <boolProp name="IfController.evaluateAll">false</boolProp>
            <boolProp name="IfController.useExpression">true</boolProp>
          </IfController>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="1.4 Clear CIF of NID" enabled="true">
              <stringProp name="HTTPSampler.path">/api/party-service/v2/admin/parties/deactivate-customer</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">PATCH</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;customerCifNumber&quot;: &quot;${cifNumberOfNID}&quot;&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                <collectionProp name="HeaderManager.headers">
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name"></stringProp>
                    <stringProp name="Header.value"></stringProp>
                  </elementProp>
                  <elementProp name="Content-Type" elementType="Header">
                    <stringProp name="Header.name">Content-Type</stringProp>
                    <stringProp name="Header.value">application/json</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">X-KEY</stringProp>
                    <stringProp name="Header.value">${adminKey}</stringProp>
                  </elementProp>
                </collectionProp>
              </HeaderManager>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n 1.4 ---------- NID - CLEAR CIF ----------&quot;)

// ✅ Lấy thông tin từ response trước đó
def responseCode = prev.getResponseCode()?.toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()
def requestUrl = prev.getURL().toString()

// ✅ Log thông tin cơ bản của request
log.info(&quot;${requestUrl} | ${responseTime}ms&quot;)

// ✅ Kiểm tra nếu response code là 400 (Not Found)
if (responseCode == &quot;400&quot;) {
    prev.setResponseOK() // Đánh dấu request thành công dù không tìm thấy dữ liệu
    log.warn(&quot;❌️ Not Found ID Number Party.&quot;)
    return
}

// ✅ Kiểm tra và log nếu response code khác 200 (lỗi ngoài mong đợi)
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    return
}

// ✅ Nếu API thành công, log xác nhận đã xoá CIF thành công
log.info(&quot;✅ Clear cifNumber of ID Number in Party Success!&quot;)
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="1.5 Phone - Get Prospect" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v2/prospect</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;phoneNumber&quot;: &quot;+84${phoneNumberOnboard}&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n 1.5 ---------- PHONE - GET PROSPECT ----------&quot;)

// ✅ Lấy thông tin từ response trước đó
def response = prev.getResponseDataAsString()?.trim()
def responseCode = prev.getResponseCode()?.toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()

// ✅ Log thông tin cơ bản của request
log.info(&quot;${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra nếu response code là 400 (Không tìm thấy prospect)
if (responseCode == &quot;400&quot;) {
    prev.setResponseOK() // Đánh dấu request thành công dù không tìm thấy dữ liệu
    log.warn(&quot;✅ Not Found Prospect from Phone Number.&quot;)
    return
}

// ✅ Kiểm tra và log nếu response code khác 200 (lỗi ngoài mong đợi)
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Parse JSON an toàn
def jsonResponse
try {
    jsonResponse = new JsonSlurper().parseText(response)
} catch (Exception e) {
    log.error(&quot;❌ JSON Parsing Error: ${e.message}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Trích xuất prospectId từ payload
def prospectIdPhone = jsonResponse?.payload?.prospectId ?: null

if (prospectIdPhone) {
    vars.put(&quot;prospectIdOfPhone&quot;, prospectIdPhone.toString())
    log.info(&quot;✅ ProspectID of Phone: ${prospectIdPhone}&quot;)
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <IfController guiclass="IfControllerPanel" testclass="IfController" testname="1.6 Phone - Clear Prospect" enabled="true">
            <stringProp name="IfController.condition">${__groovy(vars.get(&quot;prospectIdOfPhone&quot;) != null )}</stringProp>
            <boolProp name="IfController.evaluateAll">false</boolProp>
            <boolProp name="IfController.useExpression">true</boolProp>
          </IfController>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname=" 1.6 Clear Prospect of Phone" enabled="true">
              <stringProp name="HTTPSampler.path">/v2/onboarding/admin/prospect/${prospectIdOfPhone}/clean-prospect</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">POST</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
  &quot;removeAllFaces&quot;: true&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                <collectionProp name="HeaderManager.headers">
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">Content-Type</stringProp>
                    <stringProp name="Header.value">application/json</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">X-KEY</stringProp>
                    <stringProp name="Header.value">${adminKey}</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">secret-key</stringProp>
                    <stringProp name="Header.value">izyMW6MEhhjN0KQfjyb11DwM9XuJyYU6</stringProp>
                  </elementProp>
                </collectionProp>
              </HeaderManager>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n 1.6 ---------- CLEAR PROSPECT OF PHONE ----------&quot;)

// ✅ Lấy thông tin từ response trước đó
def response = prev.getResponseDataAsString()?.trim()
def responseCode = prev.getResponseCode()?.toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()

// ✅ Log thông tin cơ bản của request
log.info(&quot;${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra nếu response code là 400 (Không tìm thấy prospect)
if (responseCode == &quot;400&quot;) {
    prev.setResponseOK() // Đánh dấu request thành công dù không tìm thấy dữ liệu
    log.warn(&quot;⚠️ Not Found Prospect from Phone Number (Response 400).&quot;)
    return
}

// ✅ Kiểm tra và log nếu response code khác 200 (lỗi ngoài mong đợi)
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    return
}

// ✅ Nếu API thành công, log kết quả
log.info(&quot;✅ Clear Prospect of Phone Success!&quot;)</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="1.7 Phone - Get CIF" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/api/party-service/v2/admin/parties/lookup</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;type&quot;: &quot;onboard_phone_number&quot;,&#xd;
    &quot;value&quot;: &quot;+84${phoneNumberOnboard}&quot;,&#xd;
    &quot;queryParams&quot;: [&quot;cif&quot;]&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${adminKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n 1.7 ---------- PHONE - GET CIF ----------&quot;)

// ✅ Lấy thông tin từ response trước đó
def response = prev.getResponseDataAsString()?.trim() // Kiểm tra null tránh lỗi
def responseCode = prev.getResponseCode()?.toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()

// ✅ Log thông tin cơ bản của request
log.info(&quot;${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra nếu response code là 400 (Không tìm thấy Phone Number Party)
if (responseCode == &quot;400&quot;) {
    prev.setResponseOK() // Đánh dấu request thành công dù không tìm thấy dữ liệu
    log.warn(&quot;✅ Not Found Phone Number Party.&quot;)
    return
}

// ✅ Kiểm tra và log nếu response code khác 200 (lỗi ngoài mong đợi)
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Parse JSON an toàn
def jsonResponse
try {
    jsonResponse = new JsonSlurper().parseText(response) // Parse response JSON
} catch (Exception e) {
    log.error(&quot;❌ JSON Parsing Error: ${e.message}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Trích xuất thông tin tài khoản
def statusAccount = jsonResponse?.payload?.status ?: &quot;UNKNOWN&quot; // Mặc định &quot;UNKNOWN&quot;
def cifNumberOld = jsonResponse?.payload?.cif ?: &quot;N/A&quot; // Mặc định &quot;N/A&quot;

// ✅ Lưu giá trị vào biến JMeter
vars.put(&quot;statusAccount&quot;, statusAccount)
vars.put(&quot;cifNumberOld&quot;, cifNumberOld)

// ✅ Log thông tin tài khoản
log.info(&quot;✅ CIF Account Old: ${cifNumberOld} | Status: ${statusAccount}&quot;)
</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <IfController guiclass="IfControllerPanel" testclass="IfController" testname="1.8 Phone - Clear CIF" enabled="true">
            <stringProp name="IfController.condition">${__groovy(vars.get(&apos;statusAccount&apos;) == &apos;Active&apos;)}</stringProp>
            <boolProp name="IfController.evaluateAll">false</boolProp>
            <boolProp name="IfController.useExpression">true</boolProp>
          </IfController>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="1.8 Clear CIF of Phone" enabled="true">
              <stringProp name="HTTPSampler.path">/api/party-service/v2/admin/parties/deactivate-customer</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">PATCH</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{&#xd;
    &quot;customerCifNumber&quot;: &quot;${cifNumberOld}&quot;&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                <collectionProp name="HeaderManager.headers">
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name"></stringProp>
                    <stringProp name="Header.value"></stringProp>
                  </elementProp>
                  <elementProp name="Content-Type" elementType="Header">
                    <stringProp name="Header.name">Content-Type</stringProp>
                    <stringProp name="Header.value">application/json</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">X-KEY</stringProp>
                    <stringProp name="Header.value">${adminKey}</stringProp>
                  </elementProp>
                </collectionProp>
              </HeaderManager>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n 1.8 ---------- PHONE - CLEAR CIF ----------&quot;)

// ✅ Lấy thông tin từ request trước đó
def response = prev.getResponseDataAsString()?.trim() // Kiểm tra null tránh lỗi
def responseCode = prev.getResponseCode()?.toString()
def responseMessage = prev.getResponseMessage()
def responseTime = prev.getTime()

// ✅ Log thông tin cơ bản của request
log.info(&quot;${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra nếu response code là 400 (Không tìm thấy Phone Number Party)
if (responseCode == &quot;400&quot;) {
    prev.setResponseOK()  // Đánh dấu request thành công dù không tìm thấy dữ liệu
    log.warn(&quot;⚠️ Not Found Phone Number Party (Response 400).&quot;)
    return  // Dừng lại nếu không tìm thấy Phone Number Party
}

// ✅ Kiểm tra và log nếu response code khác 200 (lỗi ngoài mong đợi)
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return  // Dừng nếu có lỗi ngoài mong đợi
}

// ✅ Nếu API thành công, log kết quả mà không cần hiển thị response đầy đủ
log.info(&quot;✅ Clear CIF Number of Phone in Party Success!&quot;)
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
          </hashTree>
        </hashTree>
        <IfController guiclass="IfControllerPanel" testclass="IfController" testname="2. Create new Account" enabled="true">
          <stringProp name="IfController.condition">${__groovy(vars.get(&quot;phoneNumberOnboard&quot;) != null)}</stringProp>
          <boolProp name="IfController.evaluateAll">false</boolProp>
          <boolProp name="IfController.useExpression">true</boolProp>
        </IfController>
        <hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.1 Register Phone" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v3/onboarding/mobile/verify</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{ &#xd;
	&quot;deviceId&quot;: &quot;${deviceId}&quot;,&#xd;
    &quot;languageCode&quot;: &quot;vi&quot;,&#xd;
    &quot;mobileNumber&quot;: {&#xd;
        &quot;number&quot;: &quot;${phoneNumberOnboard}&quot;,&#xd;
        &quot;countryCode&quot;: &quot;+84&quot;&#xd;
     },&#xd;
     &quot;smsFooterString&quot;: &quot;123&quot;,&#xd;
    &quot;rateLimitingToken&quot;: &quot;kuhkh&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="Set Onboarding ID" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot;\n\n=============== !!! START ONBOARD NEW ACCOUNT !!! ===============\n\n&quot;);

log.info(&quot; \n 2.1 ---------- REGISTER PHONE ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);

// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `onboardingId`
def onboardingId = jsonResponse?.payload?.onboardingId ?: null

// ✅ Kiểm tra Onboarding ID
if (onboardingId) {
    vars.put(&quot;onboardingId&quot;, onboardingId);
    log.info(&quot;✅ Onboard ID: &quot; + onboardingId);
} else {
    log.error(&quot;❌ Onboarding ID not found!&quot;);
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="JSR223 PreProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import java.util.UUID

// ✅ Tạo deviceId ngẫu nhiên
//def deviceId = UUID.randomUUID().toString()
def deviceId = &quot;348014C9-2408-4818-BFAD-1C6F9E3D20F6&quot;

vars.put(&quot;deviceId&quot;, deviceId)

log.info(&quot;\n---------- GENERATE DATA ----------&quot;)

// ✅ Lấy giá trị từ biến JMeter
def phoneNumberOnboard = vars.get(&quot;phoneNumberOnboard&quot;) ?: &quot;N/A&quot;  // Đảm bảo không null
def idNumberOnboard = vars.get(&quot;idNumberOnboard&quot;) ?: &quot;N/A&quot;  // Đảm bảo không null

// ✅ Log thông tin số điện thoại, số ID, và Device ID
log.info(&quot;✅ Generated Phone Number: +84&quot; + phoneNumberOnboard)
log.info(&quot;✅ Generated ID Number: &quot; + idNumberOnboard)
log.info(&quot;✅ Generated Device ID: &quot; + deviceId)
</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.2 Verify OTP" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">v3/onboarding/mobile/${onboardingId}/otp/verify</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value"> { &#xd;
    &quot;deviceId&quot;: &quot;${deviceId}&quot;,&#xd;
    &quot;otp&quot;: &quot;112233&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">b7460507-7c47-4931-8921-3497bc6e0e6c</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="Logging Verify OTP" enabled="true">
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.2 ---------- VERIFY OTP ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `accessToken`
def accessToken = jsonResponse?.payload?.onboardingToken?.accessToken ?: null

// ✅ Kiểm tra Access Token
if (accessToken) {
    vars.put(&quot;accessToken&quot;, accessToken);
    log.info(&quot;✅ OTP xác minh thành công!&quot;);
//    log.info(&quot;Access Token: &quot; + accessToken);
} else {
    log.error(&quot;❌ Access Token not found!&quot;);
}</stringProp>
              <stringProp name="scriptLanguage">groovy</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.3 Set Resume Point" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v4/onboarding/kyc/set-resume-point</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">PUT</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
	&quot;resumePoint&quot;: &quot;SELFIE&quot;,&#xd;
	&quot;appVersion&quot;: &quot;1.0.0&quot;,&#xd;
	&quot;data&quot;: &quot;&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="Logging Resume point" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.3 ---------- SET RESUME POINT ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Nếu thành công, log kết quả
log.info(&quot;✅ Resume Point xử lý thành công!&quot;);</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.4 [MOCK] Hyperverge OCR - Create" enabled="false">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
            <stringProp name="HTTPSampler.protocol">https</stringProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">__admin/mappings</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;name&quot;: &quot;jmeter-hyperverge-mocking-conghoang-qa&quot;,&#xd;
    &quot;persistent&quot;: true,&#xd;
    &quot;request&quot;: {&#xd;
        &quot;url&quot;: &quot;/hyperverge/v1/link-kyc/results&quot;,&#xd;
        &quot;method&quot;: &quot;POST&quot;,&#xd;
        &quot;bodyPatterns&quot;: [&#xd;
            {&#xd;
                &quot;matchesJsonPath&quot;: &quot;$[?(@.transactionId == &apos;${onboardingId}&apos;)]&quot;&#xd;
            }&#xd;
        ]&#xd;
    },&#xd;
    &quot;response&quot;: {&#xd;
        &quot;status&quot;: 200,&#xd;
        &quot;jsonBody&quot;: {&#xd;
            &quot;status&quot;: &quot;success&quot;,&#xd;
            &quot;statusCode&quot;: 200,&#xd;
            &quot;metadata&quot;: {&#xd;
                &quot;requestId&quot;: &quot;1742361340009-ffa72089-02d2-40fa-985b-756cc4d9ae12&quot;,&#xd;
                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
            },&#xd;
            &quot;result&quot;: {&#xd;
                &quot;workflowDetails&quot;: {&#xd;
                    &quot;workflowId&quot;: &quot;document_verification&quot;,&#xd;
                    &quot;version&quot;: 1&#xd;
                },&#xd;
                &quot;applicationStatus&quot;: &quot;auto_approved&quot;,&#xd;
                &quot;results&quot;: [&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;countrySelected&quot;: &quot;vnm&quot;,&#xd;
                        &quot;documentSelected&quot;: &quot;id&quot;,&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;expectedDocumentSide&quot;: &quot;front&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;id_card_validation&quot;,&#xd;
                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;imageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352078056-b269611c-f19b-4b72-8dcb-8465c166db18&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: [&#xd;
                                    {&#xd;
                                        &quot;idType&quot;: &quot;cccd_chip_front&quot;,&#xd;
                                        &quot;fieldsExtracted&quot;: {&#xd;
                                            &quot;firstName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;middleName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;lastName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fullName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;HOÀNG CHÍ CÔNG&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;dateOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;20-10-1998&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;dateOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;dateOfExpiry&quot;: {&#xd;
                                                &quot;value&quot;: &quot;20-10-2038&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;countryCode&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;type&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;address&quot;: {&#xd;
                                                &quot;value&quot;: &quot;Đội 9, Thôn Nghĩa Xuy Xá, Mỹ Đức, Hà Nội&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;additionalInfo&quot;: &quot;thn ngha xuy x m c h ni&quot;,&#xd;
                                                &quot;street&quot;: &quot;ĐỘI 9&quot;,&#xd;
                                                &quot;houseNumber&quot;: &quot;&quot;,&#xd;
                                                &quot;district&quot;: &quot;HUYỆN MỸ ĐỨC&quot;,&#xd;
                                                &quot;province&quot;: &quot;THÀNH PHỐ HÀ NỘI&quot;,&#xd;
                                                &quot;zipCode&quot;: &quot;&quot;&#xd;
                                            },&#xd;
                                            &quot;gender&quot;: {&#xd;
                                                &quot;value&quot;: &quot;M&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;idNumber&quot;: {&#xd;
                                                &quot;value&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;placeOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;placeOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;yearOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;1998&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;age&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fatherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;motherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;husbandName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;spouseName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;nationality&quot;: {&#xd;
                                                &quot;value&quot;: &quot;Việt Nam&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;mrzString&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;idNumber&quot;: &quot;&quot;,&#xd;
                                                &quot;fullName&quot;: &quot;&quot;,&#xd;
                                                &quot;gender&quot;: &quot;&quot;,&#xd;
                                                &quot;dateOfBirth&quot;: &quot;&quot;,&#xd;
                                                &quot;dateOfExpiry&quot;: &quot;&quot;,&#xd;
                                                &quot;nationality&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;homeTown&quot;: {&#xd;
                                                &quot;value&quot;: &quot;Xuy Xá, Mỹ Đức, Hà Nội&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                                        &quot;isWrongSide&quot;: &quot;no&quot;,&#xd;
                                        &quot;qualityChecks&quot;: {&#xd;
                                            &quot;blur&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;glare&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 10,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;blackAndWhite&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;partialId&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 97,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;faceNotDetected&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 99,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;tamperChecks&quot;: {&#xd;
                                            &quot;photoTampered&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;ruleChecks&quot;: {&#xd;
                                            &quot;idNumberLengthMismatch&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;expiredID&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;idProvinceCodeInvalid&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;idDOBGenderCodeInvalid&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        }&#xd;
                                    }&#xd;
                                ],&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;countrySelected&quot;: &quot;vnm&quot;,&#xd;
                        &quot;documentSelected&quot;: &quot;id&quot;,&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;expectedDocumentSide&quot;: &quot;back&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;id_card_validation&quot;,&#xd;
                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-back.png&quot;,&#xd;
                        &quot;imageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-back.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352084870-78c6e11a-148b-46eb-8a58-bea23d855356&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: [&#xd;
                                    {&#xd;
                                        &quot;idType&quot;: &quot;cccd_chip_back&quot;,&#xd;
                                        &quot;fieldsExtracted&quot;: {&#xd;
                                            &quot;firstName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;middleName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;lastName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fullName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;dateOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;dateOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;03-07-2023&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;dateOfExpiry&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;countryCode&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;type&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;address&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;additionalInfo&quot;: &quot;&quot;,&#xd;
                                                &quot;street&quot;: &quot;&quot;,&#xd;
                                                &quot;houseNumber&quot;: &quot;&quot;,&#xd;
                                                &quot;district&quot;: &quot;&quot;,&#xd;
                                                &quot;province&quot;: &quot;&quot;,&#xd;
                                                &quot;zipCode&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;gender&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;idNumber&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;placeOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;placeOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;CỤC TRƯỞNG CỤC CẢNH SÁT QUẢN LÝ HÀNH CHÍNH VỀ TRẬT TỰ XÃ HỘI&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 95&#xd;
                                            },&#xd;
                                            &quot;yearOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;age&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fatherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;motherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;husbandName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;spouseName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;nationality&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;mrzString&quot;: {&#xd;
                                                &quot;value&quot;: &quot;IDVNM0980341588001098034158&lt;&lt;99810204M3810202VNM&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;8HOANG&lt;&lt;CHI&lt;CONG&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;idNumber&quot;: &quot;001098034158&quot;,&#xd;
                                                &quot;fullName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
                                                &quot;gender&quot;: &quot;M&quot;,&#xd;
                                                &quot;dateOfBirth&quot;: &quot;20-10-1998&quot;,&#xd;
                                                &quot;dateOfExpiry&quot;: &quot;20-10-2038&quot;,&#xd;
                                                &quot;nationality&quot;: &quot;VNM&quot;&#xd;
                                            },&#xd;
                                            &quot;homeTown&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-back.png&quot;,&#xd;
                                        &quot;isWrongSide&quot;: &quot;no&quot;,&#xd;
                                        &quot;qualityChecks&quot;: {&#xd;
                                            &quot;blur&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;glare&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 10,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;blackAndWhite&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;partialId&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 97,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;ruleChecks&quot;: {&#xd;
                                            &quot;mrzTampered&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        }&#xd;
                                    }&#xd;
                                ],&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;module_selfie&quot;,&#xd;
                        &quot;imageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-selfie.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352098892-4c1cad77-3d21-4291-bea6-fc202950fc19&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: {&#xd;
                                    &quot;liveFace&quot;: {&#xd;
                                        &quot;value&quot;: &quot;yes&quot;,&#xd;
                                        &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                        &quot;score&quot;: 100&#xd;
                                    },&#xd;
                                    &quot;qualityChecks&quot;: {&#xd;
                                        &quot;blur&quot;: {&#xd;
                                            &quot;score&quot;: 95,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;eyesClosed&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;eyewear&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;faceOccluded&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;hat&quot;: {&#xd;
                                            &quot;score&quot;: 99,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;headTurned&quot;: {&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;maskPresent&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;multipleFaces&quot;: {&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;nudity&quot;: {&#xd;
                                            &quot;score&quot;: 100,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        }&#xd;
                                    }&#xd;
                                },&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;module_facematch&quot;,&#xd;
                        &quot;idImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;selfieImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-selfie.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352100657-63699cc7-c8eb-4576-ada0-14fd4def8aa4&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: {&#xd;
                                    &quot;match&quot;: {&#xd;
                                        &quot;value&quot;: &quot;yes&quot;,&#xd;
                                        &quot;score&quot;: 98,&#xd;
                                        &quot;confidence&quot;: &quot;high&quot;&#xd;
                                    }&#xd;
                                },&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;nidfrontImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;selfieImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-selfie.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metaData&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352161074-2484344c-9271-4145-b183-0c62321f6dcd&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;data&quot;: {&#xd;
                                    &quot;transactionId&quot;: &quot;1351747252413558784&quot;,&#xd;
                                    &quot;requestId&quot;: &quot;1742352161074-2484344c-9271-4145-b183-0c62321f6dcd&quot;,&#xd;
                                    &quot;isEnrolled&quot;: {&#xd;
                                        &quot;value&quot;: &quot;yes&quot;,&#xd;
                                        &quot;reason&quot;: &quot;Input parameter is \&quot;yes\&quot;&quot;&#xd;
                                    },&#xd;
                                    &quot;suspiciousMatches&quot;: {&#xd;
                                        &quot;internalCount&quot;: 0,&#xd;
                                        &quot;externalCount&quot;: 0,&#xd;
                                        &quot;internal&quot;: [],&#xd;
                                        &quot;external&quot;: []&#xd;
                                    },&#xd;
                                    &quot;matches&quot;: {&#xd;
                                        &quot;internalCount&quot;: 0,&#xd;
                                        &quot;externalCount&quot;: 0,&#xd;
                                        &quot;internal&quot;: [],&#xd;
                                        &quot;external&quot;: []&#xd;
                                    },&#xd;
                                    &quot;blocklist&quot;: {&#xd;
                                        &quot;internalCount&quot;: 0,&#xd;
                                        &quot;internal&quot;: []&#xd;
                                    },&#xd;
                                    &quot;dashboardUrl&quot;: &quot;https://www.orion-console.hyperverge.co/reviewportal/1742352161074-2484344c-9271-4145-b183-0c62321f6dcd&quot;&#xd;
                                },&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;value&quot;: &quot;No record found&quot;,&#xd;
                                    &quot;action&quot;: &quot;Pass&quot;&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    }&#xd;
                ],&#xd;
                &quot;userDetails&quot;: {&#xd;
                    &quot;facematchAction&quot;: &quot;pass&quot;,&#xd;
                    &quot;selfieRequestId&quot;: &quot;1742352098892-4c1cad77-3d21-4291-bea6-fc202950fc19&quot;,&#xd;
                    &quot;facematchRequestId&quot;: &quot;1742352100657-63699cc7-c8eb-4576-ada0-14fd4def8aa4&quot;,&#xd;
                    &quot;selfieAction&quot;: &quot;pass&quot;&#xd;
                }&#xd;
            }&#xd;
        },&#xd;
        &quot;headers&quot;: {&#xd;
            &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
        },&#xd;
        &quot;transformers&quot;: [&#xd;
            &quot;response-template&quot;&#xd;
        ]&#xd;
    },&#xd;
    &quot;priority&quot;: 2,&#xd;
    &quot;metadata&quot;: {&#xd;
        &quot;wiremock-gui&quot;: {&#xd;
            &quot;folder&quot;: &quot;/mappings/hyperverge/jmeter&quot;&#xd;
        }&#xd;
    }&#xd;
}&#xd;
</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="JSR223 PreProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">//log.info(&quot;-----[MOCK] Hyperverge OCR-----&quot;);

//def digits = Long.toString(${phoneNumberOnboard});
//def CCCD = &quot;044091&quot; + digits[-6..-1]
//vars.put(&quot;idNumber&quot;, CCCD)
//log.info(&quot; \n ------------------&gt; id number: &quot; + CCCD);</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.4 ---------- [MOCK] HYPERVEGER OCR - CREATE ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;201&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `idHyperVergeOCR`
def idHyperVergeOCRNew = jsonResponse?.id ?: null

// ✅ Kiểm tra idHyperVergeOCR
if (idHyperVergeOCRNew) {
    vars.put(&quot;idHyperVergeOCRNew&quot;, idHyperVergeOCRNew);
    log.info(&quot;✅ idHyperVergeOCR Extracted: &quot; + idHyperVergeOCRNew);
} else {
    log.error(&quot;❌ idHyperVergeOCR not found!&quot;);
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.4 [MOCK] Hyperverge OCR - Update" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
            <stringProp name="HTTPSampler.protocol">https</stringProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">__admin/mappings/${hpvOcrMockingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">PUT</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;name&quot;: &quot;jmeter-hyperverge-mocking-conghoang-qa&quot;,&#xd;
    &quot;persistent&quot;: true,&#xd;
    &quot;request&quot;: {&#xd;
        &quot;url&quot;: &quot;/hyperverge/v1/link-kyc/results&quot;,&#xd;
        &quot;method&quot;: &quot;POST&quot;,&#xd;
        &quot;bodyPatterns&quot;: [&#xd;
            {&#xd;
                &quot;matchesJsonPath&quot;: &quot;$[?(@.transactionId == &apos;${onboardingId}&apos;)]&quot;&#xd;
            }&#xd;
        ]&#xd;
    },&#xd;
    &quot;response&quot;: {&#xd;
        &quot;status&quot;: 200,&#xd;
        &quot;jsonBody&quot;: {&#xd;
            &quot;status&quot;: &quot;success&quot;,&#xd;
            &quot;statusCode&quot;: 200,&#xd;
            &quot;metadata&quot;: {&#xd;
                &quot;requestId&quot;: &quot;1742361340009-ffa72089-02d2-40fa-985b-756cc4d9ae12&quot;,&#xd;
                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
            },&#xd;
            &quot;result&quot;: {&#xd;
                &quot;workflowDetails&quot;: {&#xd;
                    &quot;workflowId&quot;: &quot;document_verification&quot;,&#xd;
                    &quot;version&quot;: 1&#xd;
                },&#xd;
                &quot;applicationStatus&quot;: &quot;auto_approved&quot;,&#xd;
                &quot;results&quot;: [&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;countrySelected&quot;: &quot;vnm&quot;,&#xd;
                        &quot;documentSelected&quot;: &quot;id&quot;,&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;expectedDocumentSide&quot;: &quot;front&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;id_card_validation&quot;,&#xd;
                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;imageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352078056-b269611c-f19b-4b72-8dcb-8465c166db18&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: [&#xd;
                                    {&#xd;
                                        &quot;idType&quot;: &quot;cccd_chip_front&quot;,&#xd;
                                        &quot;fieldsExtracted&quot;: {&#xd;
                                            &quot;firstName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;middleName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;lastName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fullName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;HOÀNG CHÍ CÔNG&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;dateOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;20-10-1998&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;dateOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;dateOfExpiry&quot;: {&#xd;
                                                &quot;value&quot;: &quot;20-10-2038&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;countryCode&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;type&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;address&quot;: {&#xd;
                                                &quot;value&quot;: &quot;Đội 9, Thôn Nghĩa Xuy Xá, Mỹ Đức, Hà Nội&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;additionalInfo&quot;: &quot;thn ngha xuy x m c h ni&quot;,&#xd;
                                                &quot;street&quot;: &quot;ĐỘI 9&quot;,&#xd;
                                                &quot;houseNumber&quot;: &quot;&quot;,&#xd;
                                                &quot;district&quot;: &quot;HUYỆN MỸ ĐỨC&quot;,&#xd;
                                                &quot;province&quot;: &quot;THÀNH PHỐ HÀ NỘI&quot;,&#xd;
                                                &quot;zipCode&quot;: &quot;&quot;&#xd;
                                            },&#xd;
                                            &quot;gender&quot;: {&#xd;
                                                &quot;value&quot;: &quot;M&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;idNumber&quot;: {&#xd;
                                                &quot;value&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;placeOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;placeOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;yearOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;1998&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;age&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fatherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;motherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;husbandName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;spouseName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;nationality&quot;: {&#xd;
                                                &quot;value&quot;: &quot;Việt Nam&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;mrzString&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;idNumber&quot;: &quot;&quot;,&#xd;
                                                &quot;fullName&quot;: &quot;&quot;,&#xd;
                                                &quot;gender&quot;: &quot;&quot;,&#xd;
                                                &quot;dateOfBirth&quot;: &quot;&quot;,&#xd;
                                                &quot;dateOfExpiry&quot;: &quot;&quot;,&#xd;
                                                &quot;nationality&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;homeTown&quot;: {&#xd;
                                                &quot;value&quot;: &quot;Xuy Xá, Mỹ Đức, Hà Nội&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                                        &quot;isWrongSide&quot;: &quot;no&quot;,&#xd;
                                        &quot;qualityChecks&quot;: {&#xd;
                                            &quot;blur&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;glare&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 10,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;blackAndWhite&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;partialId&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 97,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;faceNotDetected&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 99,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;tamperChecks&quot;: {&#xd;
                                            &quot;photoTampered&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;ruleChecks&quot;: {&#xd;
                                            &quot;idNumberLengthMismatch&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;expiredID&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;idProvinceCodeInvalid&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;idDOBGenderCodeInvalid&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        }&#xd;
                                    }&#xd;
                                ],&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;countrySelected&quot;: &quot;vnm&quot;,&#xd;
                        &quot;documentSelected&quot;: &quot;id&quot;,&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;expectedDocumentSide&quot;: &quot;back&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;id_card_validation&quot;,&#xd;
                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-back.png&quot;,&#xd;
                        &quot;imageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-back.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352084870-78c6e11a-148b-46eb-8a58-bea23d855356&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: [&#xd;
                                    {&#xd;
                                        &quot;idType&quot;: &quot;cccd_chip_back&quot;,&#xd;
                                        &quot;fieldsExtracted&quot;: {&#xd;
                                            &quot;firstName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;middleName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;lastName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fullName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;dateOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;dateOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;03-07-2023&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100&#xd;
                                            },&#xd;
                                            &quot;dateOfExpiry&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;countryCode&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;type&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;address&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;additionalInfo&quot;: &quot;&quot;,&#xd;
                                                &quot;street&quot;: &quot;&quot;,&#xd;
                                                &quot;houseNumber&quot;: &quot;&quot;,&#xd;
                                                &quot;district&quot;: &quot;&quot;,&#xd;
                                                &quot;province&quot;: &quot;&quot;,&#xd;
                                                &quot;zipCode&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;gender&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;idNumber&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;placeOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;placeOfIssue&quot;: {&#xd;
                                                &quot;value&quot;: &quot;CỤC TRƯỞNG CỤC CẢNH SÁT QUẢN LÝ HÀNH CHÍNH VỀ TRẬT TỰ XÃ HỘI&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 95&#xd;
                                            },&#xd;
                                            &quot;yearOfBirth&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;age&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;fatherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;motherName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;husbandName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;spouseName&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;nationality&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;mrzString&quot;: {&#xd;
                                                &quot;value&quot;: &quot;IDVNM0980341588001098034158&lt;&lt;99810204M3810202VNM&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;8HOANG&lt;&lt;CHI&lt;CONG&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;idNumber&quot;: &quot;001098034158&quot;,&#xd;
                                                &quot;fullName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
                                                &quot;gender&quot;: &quot;M&quot;,&#xd;
                                                &quot;dateOfBirth&quot;: &quot;20-10-1998&quot;,&#xd;
                                                &quot;dateOfExpiry&quot;: &quot;20-10-2038&quot;,&#xd;
                                                &quot;nationality&quot;: &quot;VNM&quot;&#xd;
                                            },&#xd;
                                            &quot;homeTown&quot;: {&#xd;
                                                &quot;value&quot;: &quot;&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;croppedImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-back.png&quot;,&#xd;
                                        &quot;isWrongSide&quot;: &quot;no&quot;,&#xd;
                                        &quot;qualityChecks&quot;: {&#xd;
                                            &quot;blur&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;glare&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 10,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;blackAndWhite&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 100,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            },&#xd;
                                            &quot;partialId&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 97,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        },&#xd;
                                        &quot;ruleChecks&quot;: {&#xd;
                                            &quot;mrzTampered&quot;: {&#xd;
                                                &quot;value&quot;: &quot;no&quot;,&#xd;
                                                &quot;score&quot;: 0,&#xd;
                                                &quot;confidence&quot;: &quot;high&quot;&#xd;
                                            }&#xd;
                                        }&#xd;
                                    }&#xd;
                                ],&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;module_selfie&quot;,&#xd;
                        &quot;imageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-selfie.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352098892-4c1cad77-3d21-4291-bea6-fc202950fc19&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: {&#xd;
                                    &quot;liveFace&quot;: {&#xd;
                                        &quot;value&quot;: &quot;yes&quot;,&#xd;
                                        &quot;confidence&quot;: &quot;high&quot;,&#xd;
                                        &quot;score&quot;: 100&#xd;
                                    },&#xd;
                                    &quot;qualityChecks&quot;: {&#xd;
                                        &quot;blur&quot;: {&#xd;
                                            &quot;score&quot;: 95,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;eyesClosed&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;eyewear&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;faceOccluded&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;hat&quot;: {&#xd;
                                            &quot;score&quot;: 99,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;headTurned&quot;: {&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;maskPresent&quot;: {&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;multipleFaces&quot;: {&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;score&quot;: 0,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        },&#xd;
                                        &quot;nudity&quot;: {&#xd;
                                            &quot;score&quot;: 100,&#xd;
                                            &quot;value&quot;: &quot;no&quot;,&#xd;
                                            &quot;confidence&quot;: &quot;high&quot;&#xd;
                                        }&#xd;
                                    }&#xd;
                                },&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;moduleId&quot;: &quot;module_facematch&quot;,&#xd;
                        &quot;idImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;selfieImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-selfie.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;status&quot;: &quot;success&quot;,&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metadata&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352100657-63699cc7-c8eb-4576-ada0-14fd4def8aa4&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;details&quot;: {&#xd;
                                    &quot;match&quot;: {&#xd;
                                        &quot;value&quot;: &quot;yes&quot;,&#xd;
                                        &quot;score&quot;: 98,&#xd;
                                        &quot;confidence&quot;: &quot;high&quot;&#xd;
                                    }&#xd;
                                },&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;action&quot;: &quot;pass&quot;,&#xd;
                                    &quot;details&quot;: []&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;module&quot;: &quot;&quot;,&#xd;
                        &quot;nidfrontImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-front.png&quot;,&#xd;
                        &quot;selfieImageUrl&quot;: &quot;https://wiremock.sit.galaxyfinx.in/conghoangqa/conghoang-selfie.png&quot;,&#xd;
                        &quot;apiResponse&quot;: {&#xd;
                            &quot;statusCode&quot;: 200,&#xd;
                            &quot;metaData&quot;: {&#xd;
                                &quot;requestId&quot;: &quot;1742352161074-2484344c-9271-4145-b183-0c62321f6dcd&quot;,&#xd;
                                &quot;transactionId&quot;: &quot;1351747252413558784&quot;&#xd;
                            },&#xd;
                            &quot;result&quot;: {&#xd;
                                &quot;data&quot;: {&#xd;
                                    &quot;transactionId&quot;: &quot;1351747252413558784&quot;,&#xd;
                                    &quot;requestId&quot;: &quot;1742352161074-2484344c-9271-4145-b183-0c62321f6dcd&quot;,&#xd;
                                    &quot;isEnrolled&quot;: {&#xd;
                                        &quot;value&quot;: &quot;yes&quot;,&#xd;
                                        &quot;reason&quot;: &quot;Input parameter is \&quot;yes\&quot;&quot;&#xd;
                                    },&#xd;
                                    &quot;suspiciousMatches&quot;: {&#xd;
                                        &quot;internalCount&quot;: 0,&#xd;
                                        &quot;externalCount&quot;: 0,&#xd;
                                        &quot;internal&quot;: [],&#xd;
                                        &quot;external&quot;: []&#xd;
                                    },&#xd;
                                    &quot;matches&quot;: {&#xd;
                                        &quot;internalCount&quot;: 0,&#xd;
                                        &quot;externalCount&quot;: 0,&#xd;
                                        &quot;internal&quot;: [],&#xd;
                                        &quot;external&quot;: []&#xd;
                                    },&#xd;
                                    &quot;blocklist&quot;: {&#xd;
                                        &quot;internalCount&quot;: 0,&#xd;
                                        &quot;internal&quot;: []&#xd;
                                    },&#xd;
                                    &quot;dashboardUrl&quot;: &quot;https://www.orion-console.hyperverge.co/reviewportal/1742352161074-2484344c-9271-4145-b183-0c62321f6dcd&quot;&#xd;
                                },&#xd;
                                &quot;summary&quot;: {&#xd;
                                    &quot;value&quot;: &quot;No record found&quot;,&#xd;
                                    &quot;action&quot;: &quot;Pass&quot;&#xd;
                                }&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;attempts&quot;: &quot;1&quot;,&#xd;
                        &quot;previousAttempts&quot;: []&#xd;
                    }&#xd;
                ],&#xd;
                &quot;userDetails&quot;: {&#xd;
                    &quot;facematchAction&quot;: &quot;pass&quot;,&#xd;
                    &quot;selfieRequestId&quot;: &quot;1742352098892-4c1cad77-3d21-4291-bea6-fc202950fc19&quot;,&#xd;
                    &quot;facematchRequestId&quot;: &quot;1742352100657-63699cc7-c8eb-4576-ada0-14fd4def8aa4&quot;,&#xd;
                    &quot;selfieAction&quot;: &quot;pass&quot;&#xd;
                }&#xd;
            }&#xd;
        },&#xd;
        &quot;headers&quot;: {&#xd;
            &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
        },&#xd;
        &quot;transformers&quot;: [&#xd;
            &quot;response-template&quot;&#xd;
        ]&#xd;
    },&#xd;
    &quot;priority&quot;: 2,&#xd;
    &quot;metadata&quot;: {&#xd;
        &quot;wiremock-gui&quot;: {&#xd;
            &quot;folder&quot;: &quot;/mappings/hyperverge/jmeter&quot;&#xd;
        }&#xd;
    }&#xd;
}&#xd;
</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="JSR223 PreProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">//log.info(&quot;-----[MOCK] Hyperverge OCR-----&quot;);

//def digits = Long.toString(${phoneNumberOnboard});
//def CCCD = &quot;044091&quot; + digits[-6..-1]
//vars.put(&quot;idNumber&quot;, CCCD)
//log.info(&quot; \n ------------------&gt; id number: &quot; + CCCD);</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.4 ---------- [MOCK] HYPERVEGER OCR - UPDATE ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `idHyperVergeOCR`
def idHyperVergeOCR = jsonResponse?.id ?: null

// ✅ Kiểm tra idHyperVergeOCR
if (idHyperVergeOCR) {
    vars.put(&quot;idHyperVergeOCR&quot;, idHyperVergeOCR);
    log.info(&quot;✅ idHyperVergeOCR Extracted: &quot; + idHyperVergeOCR);
} else {
    log.error(&quot;❌ idHyperVergeOCR not found!&quot;);
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.5 [MOCK] HDB biometric" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
            <stringProp name="HTTPSampler.protocol">https</stringProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">__admin/mappings/${hdbBiometricMockingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">PUT</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;name&quot;: &quot;jmeter-hdb-biometric-conghoang-qa&quot;,&#xd;
    &quot;persistent&quot;: true,&#xd;
    &quot;request&quot;: {&#xd;
        &quot;url&quot;: &quot;/hdb-biometric/face-service/v1/customer/list-filter?card_id=${idNumberOnboard}&quot;,&#xd;
        &quot;method&quot;: &quot;GET&quot;&#xd;
    },&#xd;
    &quot;response&quot;: {&#xd;
        &quot;status&quot;: 200,&#xd;
        &quot;jsonBody&quot;: {&#xd;
            &quot;transaction_id&quot;: &quot;90ccf7ac-ac2a-41ef-aa48-4ef851792c99&quot;,&#xd;
            &quot;log_id&quot;: &quot;87759442-0480-11f0-9ba6-4b0f69551108-d999a0fb-apigateway-service-84d657594f-svzwm&quot;,&#xd;
            &quot;data_base64&quot;: &quot;eyJ0cmFuc2FjdGlvbl9pZCI6IjkwY2NmN2FjLWFjMmEtNDFlZi1hYTQ4LTRlZjg1MTc5MmM5OSIsImxvZ19pZCI6Ijg3NzU5NDQyLTA0ODAtMTFmMC05YmE2LTRiMGY2OTU1MTEwOC1kOTk5YTBmYi1hcGlnYXRld2F5LXNlcnZpY2UtODRkNjU3NTk0Zi1zdnp3bSIsIm1lc3NhZ2UiOiJJREctMDAwMDAwMDAiLCJvYmplY3QiOnsiY3VzdG9tZXJfZmFjZXMiOlt7ImltYWdlX3VybCI6ImVreWMtY2ljL3Zla3ljdXBsb2FkL2RkNWY4Yjk4LThmODEtNDI2YS05NTYyLWNiOGIxMGFlZTQwNS8yMDI1MDMxOS9jZTUwZjg1MC0wNDZiLTExZjAtYWU0NC1kMTBkNzA4ZTJjNDQuanBlZyIsImdyb3VwX2N1c3RvbWVyIjoiRmFjZSBzZWxmaWUiLCJjaGFubmVsIjoiVklLS0kiLCJ2ZXJpZnlfc3RhdHVzIjowLCJjcmVhdGVkX2RhdGUiOiIxOS8wMy8yMDI1IDA5OjQyOjM4Iiwic3RhdHVzIjowfSx7ImltYWdlX3VybCI6ImVreWMtY2ljL3Zla3ljdXBsb2FkL2RkNWY4Yjk4LThmODEtNDI2YS05NTYyLWNiOGIxMGFlZTQwNS8yMDI1MDMxOS9jZWY4ZjgyMS0wNDZiLTExZjAtYWU0NC02OWI1NTBlMzlmZTMuanBlZyIsImdyb3VwX2N1c3RvbWVyIjoiRmFjZSBjaGlwIiwiY2hhbm5lbCI6IlZJS0tJIiwidmVyaWZ5X3N0YXR1cyI6MSwiY3JlYXRlZF9kYXRlIjoiMTkvMDMvMjAyNSAwOTo0MjozNiIsInN0YXR1cyI6MX1dLCJ1dWlkX2N1c3RvbWVyIjoiZWJjYWRjYjktY2U2NC00ZGRlLTg4MzAtNzdhODNmNmQ3Yjc3IiwiY3VzdG9tZXJfY2FyZHMiOlt7Im9yaWdpbl9sb2NhdGlvbiI6Ilh1eSBYw6EsIE3hu7kgxJDhu6ljLCBIw6AgTuG7mWkiLCJyZWNlbnRfbG9jYXRpb24iOiLEkOG7mWkgOSwgVGjDtG4gTmdoxKlhLCBYdXkgWMOhLCBN4bu5IMSQ4bupYywgSMOgIE7hu5lpIiwiZXRobmljIjoiS2luaCIsImdlbmRlciI6Ik5hbSIsImRhZF9uYW1lIjoiSG/DoG5nIFbEg24gQ2hp4bq/biIsInJlc3VsdF9jMDYiOnsic2lnbmF0dXJlIjoiS28yN2xPcHRUWXU4VE82SVZaclJ3TGVUYlBKUW8wamRuY2JxR0tOU0J5OGhvU2tZZDNIeTZ1eDVUUitNMnFFWXN5WU9mTWJpcE02dDQvRDJTbCtxcWs4RlRCU1hnTkNWa0xRYkwzYXBWckpXeFJHNCtvUzE0Q3F2WThtZVdEaUpodEZPK05nWUl5Y29MU1lJMUNnMW5icjJ3eDB3TlNJaWFkcmNGZ1lLQXhCM05sN3RwZUNTbk15QktLVWY2RGl0dFNzenBpa2ZMbytvRG12L2UxUk91ZFZTQ0VvZzkrU1dmM3pyRTZxZkVaa0s0ZXdlMnQ4YkJRR1M0aWFpRkVqeGF6am84OXJwYWQ2OFpVSG5oQ0FzZkMvV3RpcFFuTHhMQTJLK1JWeWxSREIrTTZJK2ErNmhSUW1hZkV2MzRwSlZHeEFPRTNrdWhacGpqeVBKaXRBTG13PT0iLCJyZXNwb25kcyI6eyJyZXN1bHQiOnRydWUsInJlc3BvbnNlX2lkIjoidm5wdC0wMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAiLCJleGl0Y29kZSI6MCwidGltZSI6MCwibWVzc2FnZSI6InZhbGlkIGlkY2FyZCIsInJlc3BvbnNlSWQiOiJ2bnB0LTAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCJ9fSwicmVsaWdpb24iOiJDw7RuZyBnacOhbyIsImJpcnRoX2RheSI6IjIwLzEwLzE5OTgiLCJmZWF0dXJlcyI6Ik7hu5F0IHJ14buTaSBDOiAyY20gZMaw4bubaSBzYXUgbcOpcCBwaOG6o2kiLCJ2YWxpZF9kYXRlIjoiMjAvMTAvMjAzOCIsInNwb3VzZV9uYW1lIjoiIiwibXJ6IjoiW0lEVk5NMDk4MDM0MTU4ODAwMTA5ODAzNDE1ODw8OSwgOTgxMDIwNE0zODEwMjAyVk5NPDw8PDw8PDw8PDw4LCBIT0FORzw8Q0hJPENPTkc8PDw8PDw8PDw8PDw8PDxdIiwibmF0aW9uYWxpdHkiOiJWaeG7h3QgTmFtIiwiaXNzdWVfZGF0ZSI6IjAzLzA3LzIwMjMiLCJuYW1lIjoiSG/DoG5nIENow60gQ8O0bmciLCJvbGRfaWQiOiIwMTc0NDYyNTQiLCJpZCI6IjAwMTA5ODAzNDE1OCIsIm1vbV9uYW1lIjoiTmd1eeG7hW4gVGjhu4sgU29uIn1dfX0=&quot;,&#xd;
            &quot;data_sign&quot;: &quot;kDkBrEZeP4OJmt0fWSBqZNeb9kGsvF7EI+YAzZS/kO8keHw60cHV5UuzrL5wUK7SnK8ozC/ohrcNWuZBdw/FI9NLKb3gaDMRsK8qIpZEGjDzSA8Gla6yGqNnT9++LgBdjk5N7uVDbaMwBoC9pOxKLBdY0pa12Vz/c9i0/u3dxTtnDN1ZmA6kdTpfAlgvSzfYRM8jQV4CLuLyCtlcYcaAdA23aisb/5oI0/eAOCMd7NIx12cPxMyO1nr4YGOdt8e7guJf6Su1PM5iT5+E7uyjMbm/RWE4qfcE2ZKhD/s7sY4LqnxF125bL4rF8nWAAVYzTO+r4VeJf6nGSfyksQKNow==&quot;,&#xd;
            &quot;message&quot;: &quot;IDG-00000000&quot;,&#xd;
            &quot;object&quot;: {&#xd;
                &quot;customer_faces&quot;: [&#xd;
                    {&#xd;
                        &quot;image_url&quot;: &quot;ekyc-cic/vekycupload/dd5f8b98-8f81-426a-9562-cb8b10aee405/20250319/ce50f850-046b-11f0-ae44-d10d708e2c44.jpeg&quot;,&#xd;
                        &quot;group_customer&quot;: &quot;Face selfie&quot;,&#xd;
                        &quot;channel&quot;: &quot;VIKKI&quot;,&#xd;
                        &quot;verify_status&quot;: 0,&#xd;
                        &quot;created_date&quot;: &quot;19/03/2025 09:42:38&quot;,&#xd;
                        &quot;status&quot;: 0&#xd;
                    },&#xd;
                    {&#xd;
                        &quot;image_url&quot;: &quot;ekyc-cic/vekycupload/dd5f8b98-8f81-426a-9562-cb8b10aee405/20250319/cef8f821-046b-11f0-ae44-69b550e39fe3.jpeg&quot;,&#xd;
                        &quot;group_customer&quot;: &quot;Face chip&quot;,&#xd;
                        &quot;channel&quot;: &quot;VIKKI&quot;,&#xd;
                        &quot;verify_status&quot;: 1,&#xd;
                        &quot;created_date&quot;: &quot;19/03/2025 09:42:36&quot;,&#xd;
                        &quot;status&quot;: 1&#xd;
                    }&#xd;
                ],&#xd;
                &quot;uuid_customer&quot;: &quot;ebcadcb9-ce64-4dde-8830-77a83f6d7b77&quot;,&#xd;
                &quot;customer_cards&quot;: [&#xd;
                    {&#xd;
                        &quot;origin_location&quot;: &quot;Xuy Xá, Mỹ Đức, Hà Nội&quot;,&#xd;
                        &quot;recent_location&quot;: &quot;Đội 9, Thôn Nghĩa, Xuy Xá, Mỹ Đức, Hà Nội&quot;,&#xd;
                        &quot;ethnic&quot;: &quot;Kinh&quot;,&#xd;
                        &quot;gender&quot;: &quot;Nam&quot;,&#xd;
                        &quot;dad_name&quot;: &quot;Hoàng Văn Chiến&quot;,&#xd;
                        &quot;result_c06&quot;: {&#xd;
                            &quot;signature&quot;: &quot;Ko27lOptTYu8TO6IVZrRwLeTbPJQo0jdncbqGKNSBy8hoSkYd3Hy6ux5TR+M2qEYsyYOfMbipM6t4/D2Sl+qqk8FTBSXgNCVkLQbL3apVrJWxRG4+oS14CqvY8meWDiJhtFO+NgYIycoLSYI1Cg1nbr2wx0wNSIiadrcFgYKAxB3Nl7tpeCSnMyBKKUf6DittSszpikfLo+oDmv/e1ROudVSCEog9+SWf3zrE6qfEZkK4ewe2t8bBQGS4iaiFEjxazjo89rpad68ZUHnhCAsfC/WtipQnLxLA2K+RVylRDB+M6I+a+6hRQmafEv34pJVGxAOE3kuhZpjjyPJitALmw==&quot;,&#xd;
                            &quot;responds&quot;: {&#xd;
                                &quot;result&quot;: true,&#xd;
                                &quot;response_id&quot;: &quot;vnpt-00000000-0000-0000-0000-000000000000&quot;,&#xd;
                                &quot;exitcode&quot;: 0,&#xd;
                                &quot;time&quot;: 0,&#xd;
                                &quot;message&quot;: &quot;valid idcard&quot;,&#xd;
                                &quot;responseId&quot;: &quot;vnpt-00000000-0000-0000-0000-000000000000&quot;&#xd;
                            }&#xd;
                        },&#xd;
                        &quot;religion&quot;: &quot;Công giáo&quot;,&#xd;
                        &quot;birth_day&quot;: &quot;20/10/1998&quot;,&#xd;
                        &quot;features&quot;: &quot;Nốt ruồi C: 2cm dưới sau mép phải&quot;,&#xd;
                        &quot;valid_date&quot;: &quot;20/10/2038&quot;,&#xd;
                        &quot;spouse_name&quot;: &quot;&quot;,&#xd;
                        &quot;mrz&quot;: &quot;[IDVNM0980341588001098034158&lt;&lt;9, 9810204M3810202VNM&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;8, HOANG&lt;&lt;CHI&lt;CONG&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;]&quot;,&#xd;
                        &quot;nationality&quot;: &quot;Việt Nam&quot;,&#xd;
                        &quot;issue_date&quot;: &quot;03/07/2023&quot;,&#xd;
                        &quot;name&quot;: &quot;Hoàng Chí Công&quot;,&#xd;
                        &quot;old_id&quot;: &quot;017446254&quot;,&#xd;
                        &quot;id&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
                        &quot;mom_name&quot;: &quot;Nguyễn Thị Son&quot;&#xd;
                    }&#xd;
                ]&#xd;
            }&#xd;
        },&#xd;
        &quot;headers&quot;: {&#xd;
            &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
        },&#xd;
        &quot;transformers&quot;: [&#xd;
            &quot;response-template&quot;&#xd;
        ]&#xd;
    },&#xd;
    &quot;priority&quot;: 2,&#xd;
    &quot;metadata&quot;: {&#xd;
        &quot;wiremock-gui&quot;: {&#xd;
            &quot;folder&quot;: &quot;/mappings/hdb-biometric/jmeter&quot;&#xd;
        }&#xd;
    }&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB BIOMETRIC ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;hdbBiometricMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅ HDB Biometric Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Biometric Mock ID not found!&quot;);
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] AML Check - Low =&gt; Auto Approve" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
            <stringProp name="HTTPSampler.protocol">https</stringProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">PUT</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;L&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match Not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] HDB Check &amp; Fraud - FALSE Auto Approve" enabled="false">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
            <stringProp name="HTTPSampler.protocol">https</stringProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">PUT</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Mocking AML - inprogress" enabled="false"/>
          <hashTree>
            <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Level =  Low" enabled="false"/>
            <hashTree>
              <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Result match" enabled="false"/>
              <hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;L&quot; - &quot;matchDetails&quot; : &quot;TEST&quot; =&gt; Manual Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;L&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match Found&quot;,&#xd;
      &quot;matchDetails&quot;: &quot;TEST&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;L&quot; - &quot;matchDetails&quot; : &quot;DATA_REAL&quot; =&gt; Manual Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;L&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match Found&quot;,&#xd;
      &quot;matchDetails&quot;: [&#xd;
        {&#xd;
          &quot;sourceField&quot;: &quot;, PROSPECTNAME, NATIONALID, DATEOFBIRTH&quot;,&#xd;
          &quot;sourceData&quot;: &quot; Test FullName, 1122334455, 1994, 20-10-1994&quot;,&#xd;
          &quot;matchField&quot;: &quot; ENTITYNAME, IDENTITYNUMBER1, IDENTITYNUMBER2, DOB_YEAR, DATEOFBIRTH&quot;,&#xd;
          &quot;matchData&quot;: &quot;ENTITYNAME:Test FullName:100,IDENTITYNUMBER1:1122334455:100,IDENTITYNUMBER2:DATA NOT PRESENT:0,DOB_YEAR:1994:100,DATEOFBIRTH:20-10-1994:100&quot;,&#xd;
          &quot;listId&quot;: &quot;1320005&quot;,&#xd;
          &quot;matchScore&quot;: 100,&#xd;
          &quot;listName&quot;: &quot;ListScreenIDYOB~ListScreenIDYOB&quot;&#xd;
        }&#xd;
      ]&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
              <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Result not found" enabled="false"/>
              <hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;L&quot; - &quot;matchDetails&quot; : &quot;&quot; =&gt; Manual Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;L&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: &quot;&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;L&quot; - &quot;matchDetails&quot; : [] =&gt; Auto Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;L&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;L&quot; - &quot;matchDetails&quot; : null =&gt; Auto Approve ***" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;L&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: null&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
            </hashTree>
            <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Level = Medium" enabled="false"/>
            <hashTree>
              <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Result match" enabled="false"/>
              <hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;M&quot; - &quot;matchDetails&quot; : &quot;TEST&quot; =&gt; Manual Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;M&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match Found&quot;,&#xd;
      &quot;matchDetails&quot;: &quot;TEST&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;M&quot; - &quot;matchDetails&quot; : &quot;DATA_REAL&quot; =&gt; Manual Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;M&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match Found&quot;,&#xd;
      &quot;matchDetails&quot;: [&#xd;
        {&#xd;
          &quot;sourceField&quot;: &quot;, PROSPECTNAME, NATIONALID, DATEOFBIRTH&quot;,&#xd;
          &quot;sourceData&quot;: &quot; Test FullName, 1122334455, 1994, 20-10-1994&quot;,&#xd;
          &quot;matchField&quot;: &quot; ENTITYNAME, IDENTITYNUMBER1, IDENTITYNUMBER2, DOB_YEAR, DATEOFBIRTH&quot;,&#xd;
          &quot;matchData&quot;: &quot;ENTITYNAME:Test FullName:100,IDENTITYNUMBER1:1122334455:100,IDENTITYNUMBER2:DATA NOT PRESENT:0,DOB_YEAR:1994:100,DATEOFBIRTH:20-10-1994:100&quot;,&#xd;
          &quot;listId&quot;: &quot;1320005&quot;,&#xd;
          &quot;matchScore&quot;: 100,&#xd;
          &quot;listName&quot;: &quot;ListScreenIDYOB~ListScreenIDYOB&quot;&#xd;
        }&#xd;
      ]&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
              <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Result not found" enabled="false"/>
              <hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;M&quot; - &quot;matchDetails&quot; : &quot;&quot; =&gt; Manual Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;M&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: &quot;&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;M&quot; - &quot;matchDetails&quot; : [] =&gt; Auto Approve" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;M&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;M&quot; - &quot;matchDetails&quot; : null =&gt; Auto Approve ***" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;M&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: null&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
            </hashTree>
            <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Level = High" enabled="false"/>
            <hashTree>
              <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Result match" enabled="false"/>
              <hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;H&quot; - &quot;matchDetails&quot; : &quot;TEST&quot; =&gt; Manual Approve ***" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;H&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match Found&quot;,&#xd;
      &quot;matchDetails&quot;: &quot;TEST&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;H&quot; - &quot;matchDetails&quot; : &quot;DATA_REAL&quot; =&gt; Auto Declined" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;H&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match Found&quot;,&#xd;
      &quot;matchDetails&quot;: [&#xd;
        {&#xd;
          &quot;sourceField&quot;: &quot;, PROSPECTNAME, NATIONALID, DATEOFBIRTH&quot;,&#xd;
          &quot;sourceData&quot;: &quot; Test FullName, 1122334455, 1994, 20-10-1994&quot;,&#xd;
          &quot;matchField&quot;: &quot; ENTITYNAME, IDENTITYNUMBER1, IDENTITYNUMBER2, DOB_YEAR, DATEOFBIRTH&quot;,&#xd;
          &quot;matchData&quot;: &quot;ENTITYNAME:Test FullName:100,IDENTITYNUMBER1:1122334455:100,IDENTITYNUMBER2:DATA NOT PRESENT:0,DOB_YEAR:1994:100,DATEOFBIRTH:20-10-1994:100&quot;,&#xd;
          &quot;listId&quot;: &quot;1320005&quot;,&#xd;
          &quot;matchScore&quot;: 100,&#xd;
          &quot;listName&quot;: &quot;ListScreenIDYOB~ListScreenIDYOB&quot;&#xd;
        }&#xd;
      ]&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
              <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Result not found" enabled="false"/>
              <hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;H&quot; - &quot;matchDetails&quot; : &quot;&quot; =&gt; Manual Approve ***" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;H&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: &quot;&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;H&quot; - &quot;matchDetails&quot; : [] =&gt; Auto Declined" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;H&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;H&quot; - &quot;matchDetails&quot; : null =&gt; Auto Declined" enabled="false">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                  <stringProp name="HTTPSampler.protocol">https</stringProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;H&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: null&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${publicKey}</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="scriptLanguage">groovy</stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
            </hashTree>
            <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Edge cases" enabled="false"/>
            <hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;Low&quot; - &quot;matchDetails&quot; : [] =&gt; Manual Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;Low&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;LOW&quot; - &quot;matchDetails&quot; : [] =&gt; Manual Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;LOW&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;Medium&quot; - &quot;matchDetails&quot; : [] =&gt; Manual Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;Medium&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;MEDIUM&quot; - &quot;matchDetails&quot; : [] =&gt; Manual Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;MEDIUM&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;High&quot; - &quot;matchDetails&quot; : [] =&gt; Manual Approve ***" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;High&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;HIGH&quot; - &quot;matchDetails&quot; : [] =&gt; Manual Approve ***" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;HIGH&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : &quot;&quot; - &quot;matchDetails&quot; : [] =&gt; Manual Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: &quot;&quot;,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;riskRating&quot; : null - &quot;matchDetails&quot; : [] =&gt; Manual Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${AMLMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;jmeter-aml-check-mocking-conghoang-qa&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPath&quot;: &quot;/aml-check/SearchEngine/onboardscanData&quot;,&#xd;
    &quot;method&quot;: &quot;POST&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.nationalId == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: 0,&#xd;
      &quot;riskRating&quot;: null,&#xd;
      &quot;requestId&quot;: &quot;{{jsonPath request.body &apos;$.requestId&apos;}}&quot;,&#xd;
      &quot;prospectId&quot;: &quot;{{jsonPath request.body &apos;$.prospectId&apos;}}&quot;,&#xd;
      &quot;message&quot;: &quot;Match not Found&quot;,&#xd;
      &quot;matchDetails&quot;: []&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/ws2/AML/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] AML CHECK ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  AML Check Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ AML Check Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
            </hashTree>
          </hashTree>
          <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Mocking HDB Check &amp; Fraud - todo" enabled="false"/>
          <hashTree>
            <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Fraud = TRUE" enabled="true"/>
            <hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;TRUE&quot; - &quot;verifyStatus&quot; = &quot;1&quot; =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;TRUE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;TRUE&quot; - &quot;verifyStatus&quot; = &quot;2&quot; =&gt; Manual Review" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;TRUE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;2&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;TRUE&quot; - &quot;verifyStatus&quot; = &quot;3&quot; =&gt; Manual Review" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;TRUE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;3&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;TRUE&quot; - &quot;verifyStatus&quot; = &quot;0&quot; =&gt; Manual Review" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;TRUE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;0&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;TRUE&quot; - &quot;verifyStatus&quot; = &quot;&quot; =&gt; Manual Review" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;TRUE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;TRUE&quot; - &quot;verifyStatus&quot; = null =&gt; Manual Review" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;TRUE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: null&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;TRUE&quot; - haven&apos;t &quot;verifyStatus&quot; =&gt; Manual Review" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;TRUE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
            </hashTree>
            <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="Fraud = FALSE" enabled="true"/>
            <hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] &quot;isFraud&quot; = &quot;FALSE&quot; - &quot;verifyStatus&quot; = &quot;1&quot; =&gt; Auto Approve" enabled="true">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;00&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;11223344&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: &quot;20/10/1998&quot;,&#xd;
          &quot;customerName&quot;: &quot;HOANG CHI CONG&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Fraud = False - verifyStatus = 1 =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: null,&#xd;
          &quot;customerName&quot;: &quot;&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Fraud = False - verifyStatus = 2 =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: null,&#xd;
          &quot;customerName&quot;: &quot;&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Fraud = False - verifyStatus = 3 =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: null,&#xd;
          &quot;customerName&quot;: &quot;&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Fraud = False - verifyStatus = 0 =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: null,&#xd;
          &quot;customerName&quot;: &quot;&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Fraud = False - verifyStatus = null =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: null,&#xd;
          &quot;customerName&quot;: &quot;&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Fraud = True - verifyStatus = &quot;&quot; =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: null,&#xd;
          &quot;customerName&quot;: &quot;&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Fraud = True - haven&apos;t verifyStatus  =&gt; Auto Approve" enabled="false">
                <intProp name="HTTPSampler.concurrentPool">6</intProp>
                <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
                <stringProp name="HTTPSampler.protocol">https</stringProp>
                <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                <stringProp name="HTTPSampler.path">__admin/mappings/${hdbCheckMockingId}</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">PUT</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{&#xd;
  &quot;name&quot;: &quot;hdb-user-ws-2&quot;,&#xd;
  &quot;persistent&quot;: true,&#xd;
  &quot;request&quot;: {&#xd;
    &quot;urlPattern&quot;: &quot;/hdb-check/uat/v3/(.*)&quot;,&#xd;
    &quot;method&quot;: &quot;ANY&quot;,&#xd;
    &quot;bodyPatterns&quot;: [&#xd;
      {&#xd;
        &quot;matchesJsonPath&quot;: &quot;$[?(@.data.identificationDocument == &apos;${idNumberOnboard}&apos;)]&quot;&#xd;
      }&#xd;
    ]&#xd;
  },&#xd;
  &quot;response&quot;: {&#xd;
    &quot;status&quot;: 200,&#xd;
    &quot;jsonBody&quot;: {&#xd;
      &quot;responseCode&quot;: &quot;01&quot;,&#xd;
      &quot;responseMessage&quot;: &quot;Success&quot;,&#xd;
      &quot;data&quot;: [&#xd;
        {&#xd;
          &quot;cifNumber&quot;: &quot;00000188&quot;,&#xd;
          &quot;identificationDocument&quot;: &quot;${idNumberOnboard}&quot;,&#xd;
          &quot;dateOfBirth&quot;: null,&#xd;
          &quot;customerName&quot;: &quot;&quot;,&#xd;
          &quot;isFraud&quot;: &quot;FALSE&quot;,&#xd;
          &quot;kycType&quot;: &quot;non-KYC&quot;,&#xd;
          &quot;maker&quot;: &quot;test-maker&quot;,&#xd;
          &quot;checker&quot;: &quot;test-checker&quot;,&#xd;
          &quot;verifyStatus&quot;: &quot;1&quot;&#xd;
        }&#xd;
      ],&#xd;
      &quot;responseId&quot;: &quot;bcfa0eed-abdf-4c2d-9151-551bfaf5a173&quot;,&#xd;
      &quot;responseTime&quot;: &quot;2023-11-24T12:03:24.39&quot;&#xd;
    },&#xd;
    &quot;headers&quot;: {&#xd;
      &quot;Content-Type&quot;: &quot;application/json&quot;&#xd;
    },&#xd;
    &quot;transformers&quot;: [&#xd;
      &quot;response-template&quot;&#xd;
    ]&#xd;
  },&#xd;
  &quot;priority&quot;: 0,&#xd;
  &quot;metadata&quot;: {&#xd;
    &quot;wiremock-gui&quot;: {&#xd;
      &quot;folder&quot;: &quot;/mappings/hdbank-check/jmeter&quot;&#xd;
    }&#xd;
  }&#xd;
}</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="x-request-id" elementType="Header">
                      <stringProp name="Header.name">x-request-id</stringProp>
                      <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                    </elementProp>
                    <elementProp name="gtw-authorization" elementType="Header">
                      <stringProp name="Header.name">gtw-authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                    </elementProp>
                    <elementProp name="x-open-id" elementType="Header">
                      <stringProp name="Header.name">x-open-id</stringProp>
                      <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Language" elementType="Header">
                      <stringProp name="Header.name">Accept-Language</stringProp>
                      <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                    </elementProp>
                    <elementProp name="Content-Type" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="Accept-Encoding" elementType="Header">
                      <stringProp name="Header.name">Accept-Encoding</stringProp>
                      <stringProp name="Header.value">gzip, deflate, br</stringProp>
                    </elementProp>
                    <elementProp name="User-Agent" elementType="Header">
                      <stringProp name="Header.name">User-Agent</stringProp>
                      <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                    </elementProp>
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Accept</stringProp>
                      <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">OBD-Authorization</stringProp>
                      <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.5 ---------- [MOCK] HDB CHECK &amp; FRAUD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `hdbBiometricMockingId`
def hdbBiometricMockingId = jsonResponse?.id ?: null

// ✅ Kiểm tra hdbBiometricMockingId
if (hdbBiometricMockingId) {
    vars.put(&quot;AMLMockingId&quot;, hdbBiometricMockingId);
    log.info(&quot;✅  HDB Check &amp; Fraud Mock ID Extracted: &quot; + hdbBiometricMockingId);
} else {
    log.error(&quot;❌ HDB Check &amp; Fraud Mock ID not found!&quot;);
}</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
              </hashTree>
            </hashTree>
            <GenericController guiclass="LogicControllerGui" testclass="GenericController" testname="504 - Server error" enabled="false"/>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.6 Pre check KYC" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v4/onboarding/kyc/pre-check-kyc</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
              <collectionProp name="Arguments.arguments"/>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.6 ---------- PRECHECK KYC ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Log kết quả Precheck KYC
log.info(&quot;✅ Precheck KYC thành công! Response: &quot; + jsonResponse);</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.7 Submit info" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v4/onboarding/kyc/submit-info</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
     &quot;currentAddress&quot;: &quot;Test Address&quot;,&#xd;
	&quot;oldIdNumber&quot;: &quot;123123123&quot;,&#xd;
	&quot;languageCode&quot;: &quot;VI&quot;,&#xd;
	&quot;email&quot; : &quot;api@test.com&quot;,&#xd;
	&quot;isFatca&quot;: false,&#xd;
	&quot;isPep&quot;: false,&#xd;
	&quot;occupationCode&quot;: &quot;OC022&quot;,&#xd;
	&quot;jobPositionCode&quot;: &quot;P001&quot;,&#xd;
	&quot;issueDate&quot;: &quot;03-07-2013&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.7 ---------- SUBMIT INFO ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Log kết quả Submit Info
log.info(&quot;✅ Submit Info thành công! Response: &quot; + jsonResponse);</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.8 Create Password" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v4/onboarding/accountCreation/credential</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value"> { &#xd;
    &quot;password&quot;: &quot;QWJjZDEyMw==&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">x-session-id</stringProp>
                  <stringProp name="Header.value">${sessionId}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.8 ---------- CREATE PASSWORD ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất `cifNumber`
def cifNumber = jsonResponse?.payload?.cifId ?: null

// ✅ Kiểm tra cifNumber
if (cifNumber) {
    vars.put(&quot;cifNumber&quot;, cifNumber);
    log.info(&quot;✅ Tạo mật khẩu thành công! CIF Number: &quot; + cifNumber);
} else {
    log.error(&quot;❌ CIF NUMBER NOT FOUND!&quot;);
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.9 Triger face dedup" enabled="true">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v3/onboarding/kyc/check-face-dedup</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{ &#xd;
    &quot;os&quot;: &quot;IOS&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">x-session-id</stringProp>
                  <stringProp name="Header.value">${sessionId}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">OBD-Authorization</stringProp>
                  <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.9 ---------- TRIGGER FACEDEDUP ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Log kết quả Facededup Trigger
log.info(&quot;✅ Facededup Trigger thành công! Response: &quot; + jsonResponse);</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <WhileController guiclass="WhileControllerGui" testclass="WhileController" testname="2.10 While loop to get KYC status" enabled="true">
            <stringProp name="WhileController.condition">${__groovy(
    def attempts = (vars.get(&quot;attempts&quot;) ?: &quot;0&quot;) as Integer;
    def kycStatus = vars.get(&quot;kycStatus&quot;);

    if (kycStatus == &quot;APPROVED&quot;) return false;
    if (attempts &gt;= 30) return false;
    
    return kycStatus == null || 
           kycStatus == &quot;N_A&quot; || 
           kycStatus == &quot;NEEDS_REVIEW&quot;
)}</stringProp>
          </WhileController>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.10.1 Get KYC status" enabled="true">
              <intProp name="HTTPSampler.concurrentPool">6</intProp>
              <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
              <stringProp name="HTTPSampler.path">/v3/onboarding/kyc/kyc-status-with-details</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">GET</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
                <collectionProp name="Arguments.arguments"/>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                <collectionProp name="HeaderManager.headers">
                  <elementProp name="x-request-id" elementType="Header">
                    <stringProp name="Header.name">x-request-id</stringProp>
                    <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                  </elementProp>
                  <elementProp name="gtw-authorization" elementType="Header">
                    <stringProp name="Header.name">gtw-authorization</stringProp>
                    <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                  </elementProp>
                  <elementProp name="x-open-id" elementType="Header">
                    <stringProp name="Header.name">x-open-id</stringProp>
                    <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                  </elementProp>
                  <elementProp name="Accept-Language" elementType="Header">
                    <stringProp name="Header.name">Accept-Language</stringProp>
                    <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                  </elementProp>
                  <elementProp name="Content-Type" elementType="Header">
                    <stringProp name="Header.name">Content-Type</stringProp>
                    <stringProp name="Header.value">application/json</stringProp>
                  </elementProp>
                  <elementProp name="Accept-Encoding" elementType="Header">
                    <stringProp name="Header.name">Accept-Encoding</stringProp>
                    <stringProp name="Header.value">gzip, deflate, br</stringProp>
                  </elementProp>
                  <elementProp name="User-Agent" elementType="Header">
                    <stringProp name="Header.name">User-Agent</stringProp>
                    <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                  </elementProp>
                  <elementProp name="Accept" elementType="Header">
                    <stringProp name="Header.name">Accept</stringProp>
                    <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">x-session-id</stringProp>
                    <stringProp name="Header.value">${sessionId}</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">OBD-Authorization</stringProp>
                    <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">X-KEY</stringProp>
                    <stringProp name="Header.value">${publicKey}</stringProp>
                  </elementProp>
                </collectionProp>
              </HeaderManager>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">import groovy.json.JsonSlurper;

// ✅ Tăng số lần thử kiểm tra KYC
def attempts = Integer.parseInt(vars.get(&quot;attempts&quot;) ?: &quot;0&quot;) + 1;
vars.put(&quot;attempts&quot;, String.valueOf(attempts));

log.info(&quot; \n 2.10.1 ---------- CHECKING KYC STATUS &quot; + attempts +&quot; ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);

// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot;📜 Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot;📜 Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất thông tin KYC
def kycStatus = jsonResponse?.payload?.kycStatus?.trim() ?: &quot;N_A&quot;;
def needsReviewCheck = jsonResponse?.payload?.needsReviewCheck ?: [];
def declinedCheck = jsonResponse?.payload?.declinedCheck ?: [];
def payload = jsonResponse?.payload ?: &quot;N_A&quot;;

// ✅ Lưu giá trị vào biến JMeter
vars.put(&quot;kycStatus&quot;, kycStatus);
vars.put(&quot;needsReviewCheck&quot;, needsReviewCheck ? needsReviewCheck.join(&quot;,&quot;) : &quot;&quot;);
vars.put(&quot;declinedCheck&quot;, declinedCheck ? declinedCheck.join(&quot;,&quot;) : &quot;&quot;);

// ✅ Ghi log Payload, Needs Review Check, Declined Check
//log.info(&quot; Payload: &quot; + payload);

// ✅ Xử lý kycStatus với switch-case
switch (kycStatus) {
    case &quot;APPROVED&quot;:
        vars.put(&quot;isTriggerFinalCheck&quot;, &quot;true&quot;);
        log.info(&quot;✅ KYC is APPROVED - Stopping current loop.&quot;);
        prev.setIgnore(); // Dừng vòng lặp hiện tại
        return;

    case &quot;DECLINED&quot;:
        log.info(&quot;❌ KYC DECLINED! Declined Check Reasons: &quot; + declinedCheck);
        prev.setIgnore();
        return;

    case &quot;NEEDS_REVIEW&quot;:
        log.info(&quot; KYC NEEDS REVIEW: &quot; + needsReviewCheck);

		if (needsReviewCheck.contains(&quot;selfieCheck&quot;)) {
			log.info(&quot;Wait response 5s from HyperVerge&quot;);
            Thread.sleep(6000);
            return;
        }

        
        if (needsReviewCheck.isEmpty()) {
            vars.put(&quot;isTriggerFinalCheck&quot;, &quot;true&quot;);
            log.info(&quot; No further review required. Triggering final check.&quot;);
        }
        break;

	

    default:
//        log.warn(&quot;️ KYC Status: &quot; + kycStatus + &quot; - Continuing review process.&quot;); 
//        log.info(&quot;️&quot;);
		log.info(&quot; Payload: &quot; + payload);
		// ✅ Tạm dừng trước khi kiểm tra lại
		Thread.sleep(3456);
}

//// ✅ Tăng số lần thử kiểm tra KYC
//def attempts = Integer.parseInt(vars.get(&quot;attempts&quot;) ?: &quot;0&quot;) + 1;
//vars.put(&quot;attempts&quot;, String.valueOf(attempts));

//log.info(&quot; KYC Check Attempt: &quot; + attempts);</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <IfController guiclass="IfControllerPanel" testclass="IfController" testname="If needs review" enabled="true">
              <stringProp name="IfController.condition">${__groovy(vars.get(&quot;kycStatus&quot;).equals(&quot;NEEDS_REVIEW&quot;))}</stringProp>
              <boolProp name="IfController.evaluateAll">false</boolProp>
              <boolProp name="IfController.useExpression">true</boolProp>
            </IfController>
            <hashTree>
              <IfController guiclass="IfControllerPanel" testclass="IfController" testname="If is not trigger final check" enabled="true">
                <stringProp name="IfController.condition">${__groovy(vars.get(&quot;isTriggerFinalCheck&quot;) == null)}</stringProp>
                <boolProp name="IfController.evaluateAll">false</boolProp>
                <boolProp name="IfController.useExpression">true</boolProp>
              </IfController>
              <hashTree>
                <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="Build manual request" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import org.apache.jmeter.protocol.http.sampler.HTTPSamplerProxy
import org.apache.jmeter.threads.JMeterVariables
import groovy.json.JsonBuilder
import groovy.json.JsonOutput

// ✅ Hiển thị thông tin cập nhật manual review
log.info(&quot; \n 2.10.2 ---------- UPDATING MANUAL REVIEW ----------&quot;);

// ✅ Lấy giá trị `needsReviewCheck`
def needReviewStr = vars.get(&quot;needsReviewCheck&quot;)?.trim() ?: &quot;&quot;
if (needReviewStr.isEmpty()) {
    log.warn(&quot;⚠️ No checks found for manual review.&quot;);
    return;
}

// ✅ Chia `needsReviewCheck` thành danh sách
def needsReviewChecks = needReviewStr.split(&apos;,&apos;);

// ✅ Ghi log danh sách các review cần kiểm tra
log.info(&quot; Needs Review Checks: &quot; + needsReviewChecks.join(&quot;, &quot;));

// ✅ Xây dựng JSON cho manual update API
def manualUpdateBody = [:];
needsReviewChecks.each { check -&gt;
    manualUpdateBody[check] = &quot;MANUALLY_APPROVED&quot;;
}

// ✅ Chuyển đổi thành JSON đẹp để log
def manualUpdateJson = new JsonBuilder(manualUpdateBody).toPrettyString();
vars.put(&quot;manualUpdateJson&quot;, manualUpdateJson);

// ✅ Ghi log nội dung JSON manual update theo format rõ ràng
log.info(&quot; Manual Update JSON:\n&quot; + JsonOutput.prettyPrint(JsonOutput.toJson(manualUpdateBody)));</stringProp>
                </JSR223PreProcessor>
                <hashTree/>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.10.2 Manual Update" enabled="true">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">/v3/onboarding/admin/kyc/${onboardingId}/manual-update</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PATCH</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">${manualUpdateJson}</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">x-session-id</stringProp>
                        <stringProp name="Header.value">${sessionId}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">OBD-Authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${accessToken}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${adminKey}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">username</stringProp>
                        <stringProp name="Header.value">JMETER</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

//log.info(&quot; \n ---------- MANUAL UPDATE ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Nếu thành công, log kết quả
log.info(&quot;✅ Manual Update thành công!&quot;);</stringProp>
                    <stringProp name="scriptLanguage">groovy</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
              <IfController guiclass="IfControllerPanel" testclass="IfController" testname="If is trigger final check" enabled="true">
                <stringProp name="IfController.condition">${__groovy(vars.get(&quot;isTriggerFinalCheck&quot;) != null &amp;&amp; vars.get(&quot;isTriggerFinalCheck&quot;).equals(&quot;true&quot;))}</stringProp>
                <boolProp name="IfController.evaluateAll">false</boolProp>
                <boolProp name="IfController.useExpression">true</boolProp>
              </IfController>
              <hashTree>
                <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.10.3 Manual Final update" enabled="true">
                  <intProp name="HTTPSampler.concurrentPool">6</intProp>
                  <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
                  <stringProp name="HTTPSampler.path">/v3/onboarding/admin/kyc/${onboardingId}/final-check</stringProp>
                  <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                  <stringProp name="HTTPSampler.method">PUT</stringProp>
                  <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                  <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                  <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                    <collectionProp name="Arguments.arguments">
                      <elementProp name="" elementType="HTTPArgument">
                        <boolProp name="HTTPArgument.always_encode">false</boolProp>
                        <stringProp name="Argument.value">{&#xd;
	&quot;finalCheck&quot;: &quot;MANUALLY_APPROVED&quot;&#xd;
}&#xd;
</stringProp>
                        <stringProp name="Argument.metadata">=</stringProp>
                      </elementProp>
                    </collectionProp>
                  </elementProp>
                </HTTPSamplerProxy>
                <hashTree>
                  <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                    <collectionProp name="HeaderManager.headers">
                      <elementProp name="x-request-id" elementType="Header">
                        <stringProp name="Header.name">x-request-id</stringProp>
                        <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                      </elementProp>
                      <elementProp name="gtw-authorization" elementType="Header">
                        <stringProp name="Header.name">gtw-authorization</stringProp>
                        <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                      </elementProp>
                      <elementProp name="x-open-id" elementType="Header">
                        <stringProp name="Header.name">x-open-id</stringProp>
                        <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Language" elementType="Header">
                        <stringProp name="Header.name">Accept-Language</stringProp>
                        <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                      </elementProp>
                      <elementProp name="Content-Type" elementType="Header">
                        <stringProp name="Header.name">Content-Type</stringProp>
                        <stringProp name="Header.value">application/json</stringProp>
                      </elementProp>
                      <elementProp name="Accept-Encoding" elementType="Header">
                        <stringProp name="Header.name">Accept-Encoding</stringProp>
                        <stringProp name="Header.value">gzip, deflate, br</stringProp>
                      </elementProp>
                      <elementProp name="User-Agent" elementType="Header">
                        <stringProp name="Header.name">User-Agent</stringProp>
                        <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                      </elementProp>
                      <elementProp name="Accept" elementType="Header">
                        <stringProp name="Header.name">Accept</stringProp>
                        <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">x-session-id</stringProp>
                        <stringProp name="Header.value">${sessionId}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">X-KEY</stringProp>
                        <stringProp name="Header.value">${adminKey}</stringProp>
                      </elementProp>
                      <elementProp name="" elementType="Header">
                        <stringProp name="Header.name">username</stringProp>
                        <stringProp name="Header.value">JMETER</stringProp>
                      </elementProp>
                    </collectionProp>
                  </HeaderManager>
                  <hashTree/>
                  <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                    <stringProp name="cacheKey">true</stringProp>
                    <stringProp name="filename"></stringProp>
                    <stringProp name="parameters"></stringProp>
                    <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.10.3 ---------- MANUAL FINAL UPDATE ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info( requestUrl + &quot; | &quot; + responseTime);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Nếu API thành công, chỉ log kết quả mà không cần hiển thị response đầy đủ
log.info(&quot;✅ Manual Final Update thành công!&quot;);</stringProp>
                    <stringProp name="scriptLanguage">groovy</stringProp>
                  </JSR223PostProcessor>
                  <hashTree/>
                </hashTree>
              </hashTree>
            </hashTree>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.11 Update Status bypass OTP" enabled="true">
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/api/config-service/v1/config/update</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;configType&quot;: &quot;AUTHENTICATION_CONFIG&quot;,&#xd;
    &quot;key&quot;: &quot;is_account_whitelist_enabled&quot;,&#xd;
    &quot;value&quot;: &quot;true&quot;,&#xd;
    &quot;dataType&quot;: &quot;BOOLEAN&quot;,&#xd;
    &quot;scope&quot;: &quot;internal&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name"></stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.11 ---------- UPDATE STATUS BYPASS OTP ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Nếu API thành công, chỉ log kết quả mà không cần hiển thị response đầy đủ
log.info(&quot;✅ Update Status bypass OTP thành công!&quot;);</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.12 Create bypass OTP" enabled="true">
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/api/config-service/v1/config/create</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;configType&quot;: &quot;AUTHENTICATION_CONFIG_ACCOUNT_WHITELIST&quot;,&#xd;
    &quot;key&quot;: &quot;${cifNumber}&quot;,&#xd;
    &quot;value&quot;: &quot;{\&quot;cif\&quot;:\&quot;${cifNumber}\&quot;,\&quot;otp\&quot;:\&quot;123456\&quot;,\&quot;isBypassFaceCheck\&quot;:true}&quot;,&#xd;
    &quot;dataType&quot;: &quot;JSON&quot;,&#xd;
    &quot;scope&quot;: &quot;internal&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name"></stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${publicKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.12 ---------- CREATE BYPASS OTP ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Nếu API thành công, chỉ log kết quả mà không cần hiển thị response đầy đủ
log.info(&quot;✅ Create Bypass OTP thành công!&quot;);</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <WhileController guiclass="WhileControllerGui" testclass="WhileController" testname="2.13 Check account creation status" enabled="true">
            <stringProp name="WhileController.condition">${__groovy(
    def attempts = (vars.get(&quot;attemptsCreateAccount&quot;) ?: &quot;0&quot;) as Integer;
    def status = vars.get(&quot;accountCreationStatusOnboarded&quot;) ?: &quot;UNKNOWN&quot;;

    if (attempts &gt;= 20) return false; // Giới hạn tối đa 20 lần retry
    if (status == &quot;SUCCESS&quot;) return false; // Dừng nếu thành công
    if (status == &quot;FAILED&quot;) return true; // Tiếp tục để thực hiện re-run create account

    return true; // Nếu &quot;INPROGRESS&quot;, tiếp tục vòng lặp
)}
</stringProp>
          </WhileController>
          <hashTree>
            <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.13.1 Get Account Creation Status" enabled="true">
              <intProp name="HTTPSampler.concurrentPool">6</intProp>
              <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
              <stringProp name="HTTPSampler.path">/v2/onboarding/accountCreation/${onboardingId}/status</stringProp>
              <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
              <stringProp name="HTTPSampler.method">GET</stringProp>
              <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
              <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
              <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                <collectionProp name="Arguments.arguments">
                  <elementProp name="" elementType="HTTPArgument">
                    <boolProp name="HTTPArgument.always_encode">false</boolProp>
                    <stringProp name="Argument.value">{   &#xd;
    &quot;onboardId&quot;:&quot;${onboardingId}&quot;&#xd;
}</stringProp>
                    <stringProp name="Argument.metadata">=</stringProp>
                  </elementProp>
                </collectionProp>
              </elementProp>
            </HTTPSamplerProxy>
            <hashTree>
              <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                <collectionProp name="HeaderManager.headers">
                  <elementProp name="x-request-id" elementType="Header">
                    <stringProp name="Header.name">x-request-id</stringProp>
                    <stringProp name="Header.value">bdb97a68-7821-4c9a-8f91-a01c23459d6c</stringProp>
                  </elementProp>
                  <elementProp name="gtw-authorization" elementType="Header">
                    <stringProp name="Header.name">gtw-authorization</stringProp>
                    <stringProp name="Header.value">Bearer ${access_token}</stringProp>
                  </elementProp>
                  <elementProp name="x-open-id" elementType="Header">
                    <stringProp name="Header.name">x-open-id</stringProp>
                    <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                  </elementProp>
                  <elementProp name="Accept-Language" elementType="Header">
                    <stringProp name="Header.name">Accept-Language</stringProp>
                    <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                  </elementProp>
                  <elementProp name="Content-Type" elementType="Header">
                    <stringProp name="Header.name">Content-Type</stringProp>
                    <stringProp name="Header.value">application/json</stringProp>
                  </elementProp>
                  <elementProp name="Accept-Encoding" elementType="Header">
                    <stringProp name="Header.name">Accept-Encoding</stringProp>
                    <stringProp name="Header.value">gzip, deflate, br</stringProp>
                  </elementProp>
                  <elementProp name="User-Agent" elementType="Header">
                    <stringProp name="Header.name">User-Agent</stringProp>
                    <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                  </elementProp>
                  <elementProp name="Accept" elementType="Header">
                    <stringProp name="Header.name">Accept</stringProp>
                    <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                  </elementProp>
                  <elementProp name="" elementType="Header">
                    <stringProp name="Header.name">X-KEY</stringProp>
                    <stringProp name="Header.value">${publicKey}</stringProp>
                  </elementProp>
                </collectionProp>
              </HeaderManager>
              <hashTree/>
              <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                <stringProp name="scriptLanguage">groovy</stringProp>
                <stringProp name="parameters"></stringProp>
                <stringProp name="filename"></stringProp>
                <stringProp name="cacheKey">true</stringProp>
                <stringProp name="script">import groovy.json.JsonSlurper;


// ✅ Tăng số lần thử kiểm tra Creation Account
def attemptsCreateAccount = Integer.parseInt(vars.get(&quot;attemptsCreateAccount&quot;) ?: &quot;0&quot;) + 1;
vars.put(&quot;attemptsCreateAccount&quot;, String.valueOf(attemptsCreateAccount));

log.info(&quot; \n 2.13.1 ---------- ACCOUNT CREATION STATUS &quot;+attemptsCreateAccount+&quot; ----------&quot;);


//log.info(&quot;🔄 Account Creation Attempt: &quot; + attemptsCreateAccount);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode()?.toString();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); 
def requestUrl = prev.getURL().toString();
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản để debug
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);

// ✅ Nếu response không thành công, log lỗi &amp; tăng retry count
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Trích xuất trạng thái tạo tài khoản
def accountCreationStatusOnboarded = jsonResponse?.payload?.status?.trim() ?: &quot;UNKNOWN&quot;;
vars.put(&quot;accountCreationStatusOnboarded&quot;, accountCreationStatusOnboarded);
log.info(&quot;✅ Account creation status: &quot; + accountCreationStatusOnboarded);

// ✅ Nếu status là &quot;FAILED&quot;, lưu biến trigger cho If Controller
if (accountCreationStatusOnboarded == &quot;FAILED&quot;) {
    vars.put(&quot;triggerReRunCreateAccount&quot;, &apos;true&apos;);
    log.error(&quot;❌ Account creation FAILED.&quot;);
//    log.error(&quot;❌ Will trigger re-run after 2 minutes.&quot;);
    log.error(&quot;❌ Will trigger re-run after 2s.&quot;);
    Thread.sleep(120000);
}

// ✅ Nếu status là &quot;IN_PROGRESS&quot;, chờ trước lần thử tiếp theo
if (accountCreationStatusOnboarded == &quot;IN_PROGRESS&quot;) {
    Thread.sleep(1000);
}
</stringProp>
              </JSR223PostProcessor>
              <hashTree/>
            </hashTree>
            <IfController guiclass="IfControllerPanel" testclass="IfController" testname="2.13.2 Check Account FAILED" enabled="true">
              <stringProp name="IfController.condition">${__groovy(vars.get(&apos;triggerReRunCreateAccount&apos;) == &apos;true&apos;)}</stringProp>
              <boolProp name="IfController.evaluateAll">false</boolProp>
              <boolProp name="IfController.useExpression">true</boolProp>
            </IfController>
            <hashTree>
              <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.13.2 Re-running create account" enabled="true">
                <stringProp name="HTTPSampler.path">/v4/onboarding/accountCreation/internal/account</stringProp>
                <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
                <stringProp name="HTTPSampler.method">POST</stringProp>
                <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
                <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
                <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
                  <collectionProp name="Arguments.arguments">
                    <elementProp name="" elementType="HTTPArgument">
                      <boolProp name="HTTPArgument.always_encode">false</boolProp>
                      <stringProp name="Argument.value">{ &quot;onboardId&quot;: &quot;${onboardingId}&quot; }</stringProp>
                      <stringProp name="Argument.metadata">=</stringProp>
                    </elementProp>
                  </collectionProp>
                </elementProp>
              </HTTPSamplerProxy>
              <hashTree>
                <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
                  <stringProp name="scriptLanguage">groovy</stringProp>
                  <stringProp name="parameters"></stringProp>
                  <stringProp name="filename"></stringProp>
                  <stringProp name="cacheKey">true</stringProp>
                  <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.13.2 ---------- RE-RUN CREATE ACCOUNT ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Nếu thành công, log kết quả
log.info(&quot;✅ Re-running create account thành công!&quot;);

// ✅ Reset biến `triggerReRunCreateAccount` để tránh chạy lại không cần thiết
vars.put(&quot;triggerReRunCreateAccount&quot;, &quot;false&quot;);</stringProp>
                </JSR223PostProcessor>
                <hashTree/>
                <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
                  <collectionProp name="HeaderManager.headers">
                    <elementProp name="Accept" elementType="Header">
                      <stringProp name="Header.name">Content-Type</stringProp>
                      <stringProp name="Header.value">application/json</stringProp>
                    </elementProp>
                    <elementProp name="" elementType="Header">
                      <stringProp name="Header.name">X-KEY</stringProp>
                      <stringProp name="Header.value">${publicKey}</stringProp>
                    </elementProp>
                  </collectionProp>
                </HeaderManager>
                <hashTree/>
              </hashTree>
            </hashTree>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.14 Get Account Details - Prospect" enabled="false">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v3/onboarding/admin/prospect/${onboardingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">GET</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
              <collectionProp name="Arguments.arguments"/>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${adminKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.15 ---------- GET ACCOUNT DETAILS ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Parse JSON an toàn
def jsonResponse;
try {
    jsonResponse = new JsonSlurper().parseText(response);
} catch (Exception e) {
    log.error(&quot;❌ Lỗi parse JSON: &quot; + e.getMessage());
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

try {
    log.info(&quot;\nProspect ID: &quot; + vars.get(&quot;onboardingId&quot;));

    // ✅ Trích xuất dữ liệu Prospect từ payload một cách an toàn
    def payload = jsonResponse?.payload ?: [:];

    def fullnameProspect = payload?.customerDetails?.fullName ?: &quot;N/A&quot;;
    vars.put(&quot;fullnameProspect&quot;, fullnameProspect);
    log.info(&quot;Full Name: &quot; + fullnameProspect);

    def phoneNumberProspect = payload?.phoneNumber ?: &quot;N/A&quot;;
    vars.put(&quot;phoneNumberProspect&quot;, phoneNumberProspect);
    log.info(&quot;Phone Number: &quot; + phoneNumberProspect);

    def idNumberProspect = payload?.customerDetails?.idNumber ?: &quot;N/A&quot;;
    vars.put(&quot;idNumberProspect&quot;, idNumberProspect);
    log.info(&quot;ID Number: &quot; + idNumberProspect);

    def cifNumberProspect = payload?.accountCreation?.cifNumber ?: &quot;N/A&quot;;
    vars.put(&quot;cifNumberProspect&quot;, cifNumberProspect);
    log.info(&quot;CIF Number: &quot; + cifNumberProspect);

    def vikkiAccountNumberProspect = payload?.accountCreation?.vikkiAccountNumber ?: &quot;N/A&quot;;
    vars.put(&quot;vikkiAccountNumberProspect&quot;, vikkiAccountNumberProspect);
    log.info(&quot;Vikki Account Number: &quot; + vikkiAccountNumberProspect);

    def hdbCifNumberProspect = payload?.hdb?.hdbCifNumber ?: &quot;N/A&quot;;
    vars.put(&quot;hdbCifNumberProspect&quot;, hdbCifNumberProspect);
    log.info(&quot;HDBank CIF Number: &quot; + hdbCifNumberProspect);

    def caseIDProspect = payload?.caseId ?: &quot;N/A&quot;;
    vars.put(&quot;caseIDProspect&quot;, caseIDProspect);
    log.info(&quot;Case ID: &quot; + caseIDProspect);

    log.info(&quot;\n✅ Lấy thông tin Prospect thành công! \n&quot;);

} catch (Exception e1) {
    log.error(&quot;❌ NOT FOUND YOUR INFO: &quot; + e1.getMessage());
}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.14 Get Account Details - Write to CSV" enabled="false">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v3/onboarding/admin/prospect/${onboardingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">GET</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
              <collectionProp name="Arguments.arguments"/>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${adminKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

import java.text.SimpleDateFormat;

import java.util.Date;

import org.apache.jmeter.services.FileServer;



// Log thông tin ban đầu

log.info(&quot;\n 2.15 ---------- GET ACCOUNT DETAILS ----------&quot;);



// Lấy thông tin từ request trước đó

def responseCode = prev.getResponseCode();

def responseMessage = prev.getResponseMessage();

def response = prev.getResponseDataAsString().trim();



// Log thông tin cơ bản về request

log.info(&quot;${prev.getURL()} | ${prev.getTime()}ms&quot;);



// Kiểm tra response code và log lỗi nếu không phải 200

if (responseCode != &quot;200&quot;) {

log.error(&quot;❌ API Lỗi! Response Code: ${responseCode} | Message: ${responseMessage}&quot;);

log.error(&quot;Full Response: \n${response}&quot;);

return;

}



// Phân tích JSON response

def jsonResponse = parseJsonResponse(response);

if (jsonResponse == null) return;



// Trích xuất thông tin Prospect

def prospectData = extractProspectData(jsonResponse);



// Log thông tin prospect

logProspectInfo(prospectData);



// Ghi dữ liệu vào file CSV

writeToCSV(prospectData);



// **Phân tích JSON response**

def parseJsonResponse(String response) {

try {

return new JsonSlurper().parseText(response);

} catch (Exception e) {

log.error(&quot;❌ Lỗi khi phân tích JSON: ${e.message}&quot;);

return null;

}

}



// **Trích xuất dữ liệu Prospect từ JSON**

def extractProspectData(def jsonResponse) {

def payload = jsonResponse?.payload ?: [:];

def kycState = payload?.kycState ?: [:];



// Lấy thông tin prospect và review check

def prospect = extractBasicProspectInfo(payload);

def reviewCheckStr = generateReviewCheckStr(kycState);



// Trả về dữ liệu prospect cùng với reviewCheckStr

prospect[&quot;Review Check&quot;] = reviewCheckStr;

return prospect;

}



// **Trích xuất thông tin cơ bản của Prospect**

def extractBasicProspectInfo(def payload) {

return [

&quot;Full Name&quot; : payload?.customerDetails?.fullName ?: &quot;N/A&quot;,

&quot;Phone Number&quot; : payload?.phoneNumber ?: &quot;N/A&quot;,

&quot;ID Number&quot; : payload?.customerDetails?.idNumber ?: &quot;N/A&quot;,

&quot;CIF Number&quot; : payload?.accountCreation?.cifNumber ?: &quot;N/A&quot;,

&quot;Vikki Account Number&quot;: payload?.accountCreation?.vikkiAccountNumber ?: &quot;N/A&quot;,

&quot;HDBank CIF Number&quot; : payload?.hdb?.hdbCifNumber ?: &quot;N/A&quot;,

&quot;Case ID&quot; : payload?.caseId ?: &quot;N/A&quot;

]

}



// **Kiểm tra trạng thái KYC và tạo danh sách các mục cần kiểm tra**

def generateReviewCheckStr(def kycState) {

def reviewCheckStr = kycState.findAll { it.value != &quot;AUTO_APPROVED&quot; }

.collect { &quot;${it.key}:${it.value}&quot; }

.join(&quot;|&quot;) ?: &quot;N/A&quot;;

// log.info(&quot;Final needsReviewCheck: ${reviewCheckStr}&quot;);

return reviewCheckStr;

}



// **Log thông tin Prospect**

def logProspectInfo(def prospectData) {

log.info(&quot;\n&quot; + &quot;Prospect ID: ${vars.get(&apos;onboardingId&apos;)}&quot;);

prospectData.each { key, value -&gt;

log.info(&quot;${key}: ${value}&quot;);

}

}



// **Ghi thông tin vào file CSV**

def writeToCSV(def prospectData) {

def filePath = getCsvFilePath();

def file = new File(filePath);



// Kiểm tra nếu file không tồn tại, tạo mới và thêm header

if (!file.exists()) {

createCsvFileWithHeader(file);

}



// Convert dữ liệu thành chuỗi trước khi ghi vào CSV

def data = convertToCSVString(prospectData);



// Log dữ liệu trước khi ghi vào file

// log.info(&quot;\nWriting data to CSV: ${data}&quot;);



// Ghi dữ liệu vào file CSV

file.append(data);

}



// **Lấy đường dẫn file CSV**

def getCsvFilePath() {

return &quot;${FileServer.getFileServer().getBaseDir()}/${File.separator}conghoang_onboarding_data.csv&quot;;

}



// **Tạo file CSV nếu chưa tồn tại và thêm header**

def createCsvFileWithHeader(File file) {

file.createNewFile();

file.append(&quot;Prospect ID, Full Name, Phone Number, ID Number, CIF Number, Vikki Account Number, HDBank CIF Number, Case ID, Date, Review Check\n&quot;);

}



// **Chuyển dữ liệu thành chuỗi CSV**

def convertToCSVString(def prospectData) {

def onboardingId = vars.get(&quot;onboardingId&quot;) ?: &quot;N/A&quot;;

def fullName = prospectData[&quot;Full Name&quot;];

def phoneNumber = prospectData[&quot;Phone Number&quot;];

def idNumber = prospectData[&quot;ID Number&quot;];

def cifNumber = prospectData[&quot;CIF Number&quot;];

def vikkiAccountNumber = prospectData[&quot;Vikki Account Number&quot;];

def hdbCifNumber = prospectData[&quot;HDBank CIF Number&quot;];

def caseId = prospectData[&quot;Case ID&quot;];

def reviewCheckStr = prospectData[&quot;Review Check&quot;];



// Lấy ngày giờ hiện tại

def currentDate = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(new Date());



// Tạo chuỗi CSV

return &quot;&apos;${onboardingId},${fullName},${phoneNumber},&apos;${idNumber},${cifNumber},${vikkiAccountNumber},&apos;${hdbCifNumber},${caseId},&apos;${currentDate},${reviewCheckStr}\n&quot;;

}</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.14 Get Account Details - Write to XLSX - 1" enabled="false">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v3/onboarding/admin/prospect/${onboardingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">GET</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
              <collectionProp name="Arguments.arguments"/>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${adminKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import java.io.File;
import java.io.FileOutputStream;
import java.text.SimpleDateFormat;
import java.util.Date;
import org.apache.jmeter.services.FileServer;

// Log thông tin ban đầu
log.info(&quot;\n 2.15 ---------- GET ACCOUNT DETAILS ----------&quot;);

// Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def response = prev.getResponseDataAsString().trim();

// Log thông tin cơ bản về request
log.info(&quot;${prev.getURL()} | ${prev.getTime()}ms&quot;);

// Kiểm tra response code và log lỗi nếu không phải 200
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: ${responseCode} | Message: ${responseMessage}&quot;);
    log.error(&quot;Full Response: \n${response}&quot;);
    return;
}

// Phân tích JSON response
def jsonResponse = parseJsonResponse(response);
if (jsonResponse == null) return;

// Trích xuất thông tin Prospect
def prospectData = extractProspectData(jsonResponse);

// Log thông tin prospect
logProspectInfo(prospectData);

// Ghi dữ liệu vào file Excel
writeToExcel(prospectData);

// **Phân tích JSON response**
def parseJsonResponse(String response) {
    try {
        return new JsonSlurper().parseText(response);
    } catch (Exception e) {
        log.error(&quot;❌ Lỗi khi phân tích JSON: ${e.message}&quot;);
        return null;
    }
}

// **Trích xuất dữ liệu Prospect từ JSON**
def extractProspectData(def jsonResponse) {
    def payload = jsonResponse?.payload ?: [:];
    def kycState = payload?.kycState ?: [:];
    def prospect = extractBasicProspectInfo(payload);
    def reviewCheckStr = generateReviewCheckStr(kycState);
    prospect[&quot;Review Check&quot;] = reviewCheckStr;
    return prospect;
}

// **Trích xuất thông tin cơ bản của Prospect**
def extractBasicProspectInfo(def payload) {
    return [
        &quot;Full Name&quot; : payload?.customerDetails?.fullName ?: &quot;N/A&quot;,
        &quot;Phone Number&quot; : payload?.phoneNumber ?: &quot;N/A&quot;,
        &quot;ID Number&quot; : payload?.customerDetails?.idNumber ?: &quot;N/A&quot;,
        &quot;CIF Number&quot; : payload?.accountCreation?.cifNumber ?: &quot;N/A&quot;,
        &quot;Vikki Account Number&quot;: payload?.accountCreation?.vikkiAccountNumber ?: &quot;N/A&quot;,
        &quot;HDBank CIF Number&quot; : payload?.hdb?.hdbCifNumber ?: &quot;N/A&quot;,
        &quot;Case ID&quot; : payload?.caseId ?: &quot;N/A&quot;
    ];
}

// **Kiểm tra trạng thái KYC và tạo danh sách các mục cần kiểm tra**
def generateReviewCheckStr(def kycState) {
    return kycState.findAll { it.value != &quot;AUTO_APPROVED&quot; }
        .collect { &quot;${it.key}:${it.value}&quot; }
        .join(&quot;|&quot;) ?: &quot;N/A&quot;;
}

// **Log thông tin Prospect**
def logProspectInfo(def prospectData) {
    log.info(&quot;\nProspect ID: ${vars.get(&apos;onboardingId&apos;)}&quot;);
    prospectData.each { key, value -&gt;
        log.info(&quot;${key}: ${value}&quot;);
    }
}

// **Ghi thông tin vào file Excel**
def writeToExcel(def prospectData) {
    def filePath = getExcelFilePath();
    def file = new File(filePath);
    
    Workbook workbook;
    Sheet sheet;
    if (file.exists()) {
        workbook = WorkbookFactory.create(file);
        sheet = workbook.getSheetAt(0);
    } else {
        workbook = new XSSFWorkbook();
        sheet = workbook.createSheet(&quot;Prospects&quot;);
        createExcelHeader(sheet);
    }
    
    appendExcelRow(sheet, prospectData);
    
    FileOutputStream outputStream = new FileOutputStream(filePath);
    workbook.write(outputStream);
    outputStream.close();
    workbook.close();
}

// **Lấy đường dẫn file Excel**
def getExcelFilePath() {
    return &quot;${FileServer.getFileServer().getBaseDir()}/${File.separator}conghoang_onboarding_data.xlsx&quot;;
}

// **Tạo header cho file Excel nếu chưa tồn tại**
def createExcelHeader(Sheet sheet) {
    Row headerRow = sheet.createRow(0);
    String[] headers = [&quot;Prospect ID&quot;, &quot;Full Name&quot;, &quot;Phone Number&quot;, &quot;ID Number&quot;, &quot;CIF Number&quot;, &quot;Vikki Account Number&quot;, &quot;HDBank CIF Number&quot;, &quot;Case ID&quot;, &quot;Date&quot;, &quot;Review Check&quot;];
    headers.eachWithIndex { header, index -&gt;
        headerRow.createCell(index).setCellValue(header);
    }
}

// **Thêm dòng dữ liệu mới vào file Excel**
def appendExcelRow(Sheet sheet, def prospectData) {
    int lastRowNum = sheet.getLastRowNum();
    Row row = sheet.createRow(lastRowNum + 1);
    
    def onboardingId = vars.get(&quot;onboardingId&quot;) ?: &quot;N/A&quot;;
    def currentDate = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(new Date());
    
    String[] values = [
        onboardingId,
        prospectData[&quot;Full Name&quot;],
        prospectData[&quot;Phone Number&quot;],
        prospectData[&quot;ID Number&quot;],
        prospectData[&quot;CIF Number&quot;],
        prospectData[&quot;Vikki Account Number&quot;],
        prospectData[&quot;HDBank CIF Number&quot;],
        prospectData[&quot;Case ID&quot;],
        currentDate,
        prospectData[&quot;Review Check&quot;]
    ];
    
    values.eachWithIndex { value, index -&gt;
        row.createCell(index).setCellValue(value);
    }
}
</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.14 Get Account Details - Write to XLSX">
            <intProp name="HTTPSampler.concurrentPool">6</intProp>
            <stringProp name="HTTPSampler.contentEncoding">UTF-8</stringProp>
            <stringProp name="HTTPSampler.path">/v3/onboarding/admin/prospect/${onboardingId}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">GET</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
              <collectionProp name="Arguments.arguments"/>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${adminKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper
import org.apache.poi.ss.usermodel.*
import org.apache.poi.xssf.usermodel.XSSFWorkbook
import java.io.*
import java.text.SimpleDateFormat
import java.util.Date
import org.apache.jmeter.services.FileServer

log.info(&quot;\n 2.15 ---------- GET ACCOUNT DETAILS ----------&quot;)

// Lấy thông tin response
def responseCode = prev.getResponseCode()
def responseMessage = prev.getResponseMessage()
def response = prev.getResponseDataAsString().trim()

log.info(&quot;${prev.getURL()} | ${prev.getTime()}ms&quot;)

if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// Phân tích JSON response
def jsonResponse = parseJson(response)
if (!jsonResponse) return

// Trích xuất dữ liệu prospect
def prospectData = extractProspectData(jsonResponse)
logProspectInfo(prospectData)

// Ghi vào Excel
writeToExcel(prospectData)

// =================== HÀM XỬ LÝ ===================

def parseJson(String response) {
    try {
        return new JsonSlurper().parseText(response)
    } catch (Exception e) {
        log.error(&quot;❌ Lỗi khi phân tích JSON: ${e.message}&quot;)
        return null
    }
}

def extractProspectData(def jsonResponse) {
    def payload = jsonResponse?.payload ?: [:]
    def kycState = payload?.kycState ?: [:]

    return [
        &quot;Full Name&quot;: payload?.customerDetails?.fullName ?: &quot;N/A&quot;,
        &quot;Phone Number&quot;: payload?.phoneNumber ?: &quot;N/A&quot;,
        &quot;ID Number&quot;: payload?.customerDetails?.idNumber ?: &quot;N/A&quot;,
        &quot;CIF Number&quot;: payload?.accountCreation?.cifNumber ?: &quot;N/A&quot;,
        &quot;Vikki Number&quot;: payload?.accountCreation?.vikkiAccountNumber ?: &quot;N/A&quot;,
        &quot;HDB CIF&quot;: payload?.hdb?.hdbCifNumber ?: &quot;N/A&quot;,
        &quot;Case ID&quot;: payload?.caseId ?: &quot;N/A&quot;,
        &quot;Review Check&quot;: generateReviewCheckStr(kycState),
        &quot;Note&quot;: &quot;&quot;
    ]
}

def generateReviewCheckStr(def kycState) {
    return kycState.findAll { it.value != &quot;AUTO_APPROVED&quot; }
        .collect { &quot;${it.key}:${it.value}&quot; }
        .join(&quot;|&quot;) ?: &quot;KYC AUTO APPROVED&quot;
}

def logProspectInfo(def prospectData) {
    log.info(&quot;\nProspect ID: ${vars.get(&apos;onboardingId&apos;)}&quot;)
    prospectData.each { key, value -&gt;
        log.info(&quot;${key}: ${value}&quot;)
    }
}

def writeToExcel(def prospectData) {
    def filePath = getExcelFilePath()
    def file = new File(filePath)
    
    Workbook workbook
    Sheet sheet

    if (file.exists() &amp;&amp; file.length() &gt; 0) {
        file.withInputStream { fis -&gt;
            workbook = WorkbookFactory.create(fis)
            sheet = workbook.getSheetAt(0)
        }
    } else {
        workbook = new XSSFWorkbook()
        sheet = workbook.createSheet(&quot;Prospects&quot;)
        createExcelHeader(sheet)
    }

    appendExcelRow(sheet, prospectData, workbook)

    file.withOutputStream { fos -&gt;
        workbook.write(fos)
    }
    
    workbook.close()
}

def getExcelFilePath() {
    return &quot;${FileServer.getFileServer().getBaseDir()}/conghoang_onboarding_data.xlsx&quot;
}

def createExcelHeader(Sheet sheet) {
    Row headerRow = sheet.createRow(0)
    String[] headers = [&quot;Prospect ID&quot;, &quot;Full Name&quot;, &quot;Phone Number&quot;, &quot;ID Number&quot;, &quot;CIF Number&quot;, 
                        &quot;Vikki Number&quot;, &quot;HDB CIF&quot;, &quot;Case ID&quot;, &quot;Date&quot;, &quot;Review Check&quot;, &quot;Note&quot;]

    Workbook workbook = sheet.getWorkbook()
    CellStyle headerStyle = createHeaderCellStyle(workbook)

    headers.eachWithIndex { header, index -&gt;
        Cell cell = headerRow.createCell(index)
        cell.setCellValue(header)
        cell.setCellStyle(headerStyle)
        sheet.setColumnWidth(index, index in [2, 3, 4, 5, 6] ? 4000 : 5000)
    }
}

def appendExcelRow(Sheet sheet, def prospectData, Workbook workbook) {
    int lastRowNum = sheet.getLastRowNum()
    for (int i = lastRowNum; i &gt;= 1; i--) { 
        Row oldRow = sheet.getRow(i)
        Row newRow = sheet.createRow(i + 1)
        
        if (oldRow != null) {
            newRow.setHeight(oldRow.getHeight())
            for (int j = 0; j &lt; oldRow.getLastCellNum(); j++) {
                Cell oldCell = oldRow.getCell(j)
                if (oldCell != null) {
                    Cell newCell = newRow.createCell(j)
                    newCell.setCellValue(oldCell.toString())
                    newCell.setCellStyle(oldCell.getCellStyle())
                }
            }
        }
    }

    Row newRow = sheet.createRow(1)
    def onboardingId = vars.get(&quot;onboardingId&quot;) ?: &quot;N/A&quot;
    def currentDate = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;).format(new Date())

    String[] values = [
        onboardingId,
        prospectData[&quot;Full Name&quot;],
        prospectData[&quot;Phone Number&quot;],
        prospectData[&quot;ID Number&quot;],
        prospectData[&quot;CIF Number&quot;],
        prospectData[&quot;Vikki Number&quot;],
        prospectData[&quot;HDB CIF&quot;],
        prospectData[&quot;Case ID&quot;],
        currentDate,
        prospectData[&quot;Review Check&quot;]
    ]

    CellStyle cellStyle = createCellStyle(workbook)
    values.eachWithIndex { value, index -&gt;
        Cell cell = newRow.createCell(index)
        cell.setCellValue(value)
        cell.setCellStyle(cellStyle)
    }
    newRow.setHeightInPoints(30.0f)

    Cell noteCell = newRow.createCell(10)
    noteCell.setCellValue(&quot;&quot;)
    noteCell.setCellStyle(cellStyle)
    sheet.setColumnWidth(10, 8000)

//    log.info(&quot;✅ Dữ liệu đã ghi vào dòng đầu tiên sau header: ${values.join(&apos; | &apos;)}&quot;)
}

def createHeaderCellStyle(Workbook workbook) {
    CellStyle style = createCellStyle(workbook)
    Font font = workbook.createFont()
    font.setBold(true)
    font.setColor(IndexedColors.WHITE.getIndex())
    style.setFont(font)
    style.setFillForegroundColor(IndexedColors.BLUE_GREY.getIndex())
    style.setFillPattern(FillPatternType.SOLID_FOREGROUND)
    return style
}

def createCellStyle(Workbook workbook) {
    CellStyle style = workbook.createCellStyle()
    style.setAlignment(HorizontalAlignment.CENTER)
    style.setVerticalAlignment(VerticalAlignment.CENTER)
    style.setBorderTop(BorderStyle.THIN)
    style.setBorderBottom(BorderStyle.THIN)
    style.setBorderLeft(BorderStyle.THIN)
    style.setBorderRight(BorderStyle.THIN)
    style.setWrapText(true)
    return style
}
</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="[MOCK] Hyperverge OCR - Delete" enabled="false">
            <stringProp name="HTTPSampler.domain">wiremock.sit.galaxyfinx.in</stringProp>
            <stringProp name="HTTPSampler.path">__admin/mappings/${idHyperVergeOCRNew}</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">DELETE</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
              <collectionProp name="Arguments.arguments"/>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper

log.info(&quot;\n ----- DELETE [MOCK] HYPERVERGE OCR -----&quot;)

// ✅ Lấy thông tin từ request trước đó
def response = prev.getResponseDataAsString()?.trim()  // Đảm bảo response không null
def responseCode = prev.getResponseCode()?.toString()  // Lấy mã trạng thái response
def responseMessage = prev.getResponseMessage()  // Lấy thông điệp response
def responseTime = prev.getTime()  // Lấy thời gian phản hồi

// ✅ Log thông tin cơ bản của request
log.info(&quot;Request URL: ${prev.getURL()} | ${responseTime}ms&quot;)

// ✅ Kiểm tra nếu response code khác 201 (DELETE thành công trả về 201)
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Error! Response Code: ${responseCode} | Message: ${responseMessage}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Parse JSON an toàn
def jsonResponse
try {
    jsonResponse = new JsonSlurper().parseText(response)  // Parse response JSON
} catch (Exception e) {
    log.error(&quot;❌ JSON Parsing Error: ${e.message}&quot;)
    log.error(&quot;Full Response: \n${response}&quot;)
    return
}

// ✅ Log kết quả thành công
def idHyperVergeOCRNew = vars.get(&quot;idHyperVergeOCRNew&quot;) ?: &quot;N/A&quot;  // Lấy ID mock OCR từ biến JMeter (nếu có)
log.info(&quot;✅ Delete Mock HyperVerge successful: ${idHyperVergeOCRNew}&quot;)
</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="2.15 Up vKYC" enabled="false">
            <stringProp name="HTTPSampler.path">/v2/onboarding/admin/kyc/video</stringProp>
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
              <collectionProp name="Arguments.arguments">
                <elementProp name="" elementType="HTTPArgument">
                  <boolProp name="HTTPArgument.always_encode">false</boolProp>
                  <stringProp name="Argument.value">{&#xd;
    &quot;cifNumber&quot;: &quot;${cifNumber}&quot;,&#xd;
    &quot;videoCaseId&quot;: &quot;&quot;,&#xd;
    &quot;status&quot;: &quot;PASS&quot;,&#xd;
    &quot;caseType&quot;: &quot;LIMIT_VKYC&quot;&#xd;
}</stringProp>
                  <stringProp name="Argument.metadata">=</stringProp>
                </elementProp>
              </collectionProp>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="x-request-id" elementType="Header">
                  <stringProp name="Header.name">x-request-id</stringProp>
                  <stringProp name="Header.value">dcb51815-7759-41d8-8fd6-46b32e241acf</stringProp>
                </elementProp>
                <elementProp name="gtw-authorization" elementType="Header">
                  <stringProp name="Header.name">gtw-authorization</stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="baggage" elementType="Header">
                  <stringProp name="Header.name">baggage</stringProp>
                  <stringProp name="Header.value">sentry-environment=uat,sentry-transaction=StartupScreen,sentry-public_key=a8650128baf78c0abc77876f8736238f,sentry-trace_id=ae79a0eed0354e439ab2d6820a04d617,sentry-sample_rate=0.85</stringProp>
                </elementProp>
                <elementProp name="Accept-Language" elementType="Header">
                  <stringProp name="Header.name">Accept-Language</stringProp>
                  <stringProp name="Header.value">en-GB,en-US;q=0.9,en;q=0.8</stringProp>
                </elementProp>
                <elementProp name="sentry-trace" elementType="Header">
                  <stringProp name="Header.name">sentry-trace</stringProp>
                  <stringProp name="Header.value">ae79a0eed0354e439ab2d6820a04d617-ae34fb51315f7476-1</stringProp>
                </elementProp>
                <elementProp name="Accept" elementType="Header">
                  <stringProp name="Header.name">Accept</stringProp>
                  <stringProp name="Header.value">application/json, text/plain, */*</stringProp>
                </elementProp>
                <elementProp name="x-open-id" elementType="Header">
                  <stringProp name="Header.name">x-open-id</stringProp>
                  <stringProp name="Header.value">7b0e270b-c4f4-4cc4-826c-f324bd2d6684</stringProp>
                </elementProp>
                <elementProp name="Content-Type" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="Accept-Encoding" elementType="Header">
                  <stringProp name="Header.name">Accept-Encoding</stringProp>
                  <stringProp name="Header.value">gzip, deflate, br</stringProp>
                </elementProp>
                <elementProp name="User-Agent" elementType="Header">
                  <stringProp name="Header.name">User-Agent</stringProp>
                  <stringProp name="Header.value">Vikki%20Uat/1698985660 CFNetwork/1410.0.3 Darwin/22.6.0</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">${adminKey}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
            <JSR223PostProcessor guiclass="TestBeanGUI" testclass="JSR223PostProcessor" testname="JSR223 PostProcessor" enabled="true">
              <stringProp name="scriptLanguage">groovy</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import groovy.json.JsonSlurper;

log.info(&quot; \n 2.14 ---------- UP vKYC ----------&quot;);

// ✅ Lấy thông tin từ request trước đó
def responseCode = prev.getResponseCode();
def responseMessage = prev.getResponseMessage();
def responseTime = prev.getTime(); // Response time in milliseconds
def requestUrl = prev.getURL().toString(); // Lấy URL của request
def response = prev.getResponseDataAsString().trim();

// ✅ Log thông tin cơ bản về request để hỗ trợ trace issue
log.info(requestUrl + &quot; | &quot; + responseTime + &quot;ms&quot;);


// ✅ Nếu response code != 200, log lỗi &amp; toàn bộ response để debug
if (responseCode != &quot;200&quot;) {
    log.error(&quot;❌ API Lỗi! Response Code: &quot; + responseCode + &quot; | Message: &quot; + responseMessage);
    log.error(&quot; Full Response: \n&quot; + response);
    return;
}

// ✅ Nếu API thành công, chỉ log kết quả mà không cần hiển thị response đầy đủ
log.info(&quot;✅ Up vKYC thành công!&quot;);</stringProp>
            </JSR223PostProcessor>
            <hashTree/>
          </hashTree>
          <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Incoming transaction from HDB" enabled="false">
            <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
            <stringProp name="HTTPSampler.method">POST</stringProp>
            <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
            <boolProp name="HTTPSampler.postBodyRaw">false</boolProp>
            <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables">
              <collectionProp name="Arguments.arguments"/>
            </elementProp>
          </HTTPSamplerProxy>
          <hashTree>
            <JSR223PreProcessor guiclass="TestBeanGUI" testclass="JSR223PreProcessor" testname="JSR223 PreProcessor" enabled="false">
              <stringProp name="scriptLanguage">beanshell</stringProp>
              <stringProp name="parameters"></stringProp>
              <stringProp name="filename"></stringProp>
              <stringProp name="cacheKey">true</stringProp>
              <stringProp name="script">import javax.crypto.Mac
import javax.crypto.spec.SecretKeySpec
import org.apache.commons.codec.binary.Base64
import groovy.json.JsonOutput

// 🔹 Tạo timestamp
def current = new Date()
def timestamp = current.format(&quot;yyyy-MM-dd&apos;T&apos;HH:mm:ss.SSS&apos;Z&apos;&quot;)
log.info(&quot;timestamp: &quot; + timestamp)
vars.put(&quot;timestamp&quot;, timestamp)

// 🔹 Tạo refNo (random số 12 chữ số)
def refNo = (Math.abs(new Random().nextLong()) % 900000000000) + 100000000000
log.info(&quot;refNo: &quot; + refNo)
vars.put(&quot;refNo&quot;, refNo.toString())

// 🔹 Set giá trị tài khoản
def vikkiAccountNumberProspect = &quot;880679145&quot;  // Thay bằng biến môi trường nếu cần

// 🔹 Chuẩn bị body JSON (format chuẩn)
def body = JsonOutput.toJson([
    amount: 490000000,
    refNo: vars.get(&quot;refNo&quot;),
    currency: &quot;VND&quot;,
    transmissionDatevars.get(&quot;timestamp&quot;),
    fromAccount: &quot;0421000487800&quot;,
    fromAccountName: &quot;ADECCO HR Vietnam&quot;,
    toAccount: vikkiAccountNumberProspect,
    contentTransfers: &quot;FinX Bonus&quot;,
    timestamp: vars.get(&quot;timestamp&quot;)
])

log.info(&quot;Request Body: &quot; + body)
vars.put(&quot;requestBody&quot;, body)

// 🔹 Chuẩn bị raw string để ký (giữ nguyên format như Postman)
def raw = vars.get(&quot;timestamp&quot;) + &quot;POST&quot; + &quot;/api/payment-integration/v1/hdb/transaction&quot; + body
log.info(&quot;Raw String to Sign: &quot; + raw)
vars.put(&quot;rawString&quot;, raw)

// 🔹 Ký HMAC-SHA256 + Encode Base64
def secret = &quot;th6r+5hgK+X+Tt9J&quot;  // Thay bằng giá trị thật nếu cần
Mac sha256_HMAC = Mac.getInstance(&quot;HmacSHA256&quot;)
SecretKeySpec secret_key = new SecretKeySpec(secret.getBytes(&quot;UTF-8&quot;), &quot;HmacSHA256&quot;)
sha256_HMAC.init(secret_key)

byte[] hash = sha256_HMAC.doFinal(raw.getBytes(&quot;UTF-8&quot;))
String signature = Base64.encodeBase64String(hash)

log.info(&quot;Generated X-Payload-Signature: &quot; + signature)
vars.put(&quot;signature&quot;, signature)
</stringProp>
            </JSR223PreProcessor>
            <hashTree/>
            <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="false">
              <collectionProp name="HeaderManager.headers">
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name"></stringProp>
                  <stringProp name="Header.value"></stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">Content-Type</stringProp>
                  <stringProp name="Header.value">application/json</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-KEY</stringProp>
                  <stringProp name="Header.value">GfS39omUfRHReT3G02sSYTIpF</stringProp>
                </elementProp>
                <elementProp name="" elementType="Header">
                  <stringProp name="Header.name">X-Payload-Signature</stringProp>
                  <stringProp name="Header.value">${signature}</stringProp>
                </elementProp>
              </collectionProp>
            </HeaderManager>
            <hashTree/>
          </hashTree>
        </hashTree>
      </hashTree>
      <ResultCollector guiclass="ViewResultsFullVisualizer" testclass="ResultCollector" testname="View Results Tree" enabled="true">
        <boolProp name="ResultCollector.error_logging">false</boolProp>
        <objProp>
          <name>saveConfig</name>
          <value class="SampleSaveConfiguration">
            <time>true</time>
            <latency>true</latency>
            <timestamp>true</timestamp>
            <success>true</success>
            <label>true</label>
            <code>true</code>
            <message>true</message>
            <threadName>true</threadName>
            <dataType>true</dataType>
            <encoding>false</encoding>
            <assertions>true</assertions>
            <subresults>true</subresults>
            <responseData>false</responseData>
            <samplerData>false</samplerData>
            <xml>false</xml>
            <fieldNames>true</fieldNames>
            <responseHeaders>false</responseHeaders>
            <requestHeaders>false</requestHeaders>
            <responseDataOnError>false</responseDataOnError>
            <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
            <assertionsResultsToSave>0</assertionsResultsToSave>
            <bytes>true</bytes>
            <sentBytes>true</sentBytes>
            <url>true</url>
            <threadCounts>true</threadCounts>
            <idleTime>true</idleTime>
            <connectTime>true</connectTime>
          </value>
        </objProp>
        <stringProp name="filename"></stringProp>
      </ResultCollector>
      <hashTree/>
      <ResultCollector guiclass="TableVisualizer" testclass="ResultCollector" testname="View Results in Table" enabled="true">
        <boolProp name="ResultCollector.error_logging">false</boolProp>
        <objProp>
          <name>saveConfig</name>
          <value class="SampleSaveConfiguration">
            <time>true</time>
            <latency>true</latency>
            <timestamp>true</timestamp>
            <success>true</success>
            <label>true</label>
            <code>true</code>
            <message>true</message>
            <threadName>true</threadName>
            <dataType>true</dataType>
            <encoding>false</encoding>
            <assertions>true</assertions>
            <subresults>true</subresults>
            <responseData>false</responseData>
            <samplerData>false</samplerData>
            <xml>false</xml>
            <fieldNames>true</fieldNames>
            <responseHeaders>false</responseHeaders>
            <requestHeaders>false</requestHeaders>
            <responseDataOnError>false</responseDataOnError>
            <saveAssertionResultsFailureMessage>true</saveAssertionResultsFailureMessage>
            <assertionsResultsToSave>0</assertionsResultsToSave>
            <bytes>true</bytes>
            <sentBytes>true</sentBytes>
            <url>true</url>
            <threadCounts>true</threadCounts>
            <idleTime>true</idleTime>
            <connectTime>true</connectTime>
          </value>
        </objProp>
        <stringProp name="filename"></stringProp>
      </ResultCollector>
      <hashTree/>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
